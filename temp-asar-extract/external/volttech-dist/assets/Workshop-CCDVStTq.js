import{c as g,r as o,j as e}from"./index-CEqdjNqX.js";import{C as U}from"./chevron-up-97sxatIs.js";import{R as Y}from"./refresh-cw-DBu6amVw.js";import{P as W}from"./play-txtn9UkQ.js";import{F as K}from"./folder-_XQVCBIa.js";import{F as y}from"./file-code-BmPtfYDB.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M14.5 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v3.8",key:"1kchwa"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11.7 14.2 7 17l-4.7-2.8",key:"1yk8tc"}],["path",{d:"M3 13.1a2 2 0 0 0-.999 1.76v3.24a2 2 0 0 0 .969 1.78L6 21.7a2 2 0 0 0 2.03.01L11 19.9a2 2 0 0 0 1-1.76V14.9a2 2 0 0 0-.97-1.78L8 11.3a2 2 0 0 0-2.03-.01z",key:"19flxy"}],["path",{d:"M7 17v5",key:"1yj1jh"}]],v=g("file-box",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],J=g("house",G);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],X=g("save",Q),re=()=>{var $;const[N,T]=o.useState([]),[l,D]=o.useState(null),[w,C]=o.useState(""),[i,S]=o.useState(""),[k,m]=o.useState(!1),[j,F]=o.useState(!1),[h,I]=o.useState(""),[b,E]=o.useState(null),[d,P]=o.useState(null),[f,L]=o.useState(null),[u,O]=o.useState(null),[H,r]=o.useState(["Workshop v3.0 - Real File Browser & Compilation","Ready for input."]),n=(($=window.electron)==null?void 0:$.api)||window.electronAPI,x=async s=>{if(n){m(!0);try{const t=s||i||"D:\\",a=await n.browseDirectory(t);S(t);const c=a.sort((p,M)=>p.type!==M.type?p.type==="folder"?-1:1:p.name.localeCompare(M.name));T(c),r(p=>[...p,`[MOSSY] Browsing complete. Directory structure for ${t} mapped, Architect.`])}catch(t){r(a=>[...a,`> Error browsing directory: ${t}`])}finally{m(!1)}}},R=async s=>{if(!(!n||s.type==="folder")){m(!0);try{const t=await n.readFile(s.path);if(C(t),D(s),r(a=>[...a,`> Opened: ${s.name}`]),s.fileType==="psc"){const a=await n.parseScriptDeps(s.path);P(a),r(c=>[...c,`> Dependencies: ${a.imports.length} imports, ${a.references.length} references`])}else if(s.fileType==="dds"){const a=await n.readDdsPreview(s.path);O(a),r(c=>[...c,`> Texture: ${a.width}x${a.height} (${a.format})`])}else if(s.fileType==="nif"){const a=await n.readNifInfo(s.path);L(a),a&&r(c=>[...c,`> Mesh: ${a.vertices} vertices, ${a.triangles} triangles`])}}catch(t){r(a=>[...a,`> Error loading file: ${t}`])}finally{m(!1)}}},z=async()=>{if(!(!n||!l))try{const s=await n.writeFile(l.path,w);r(s?t=>[...t,`> Saved: ${l.name}`]:t=>[...t,`> Failed to save: ${l.name}`])}catch(s){r(t=>[...t,`> Error saving file: ${s}`])}},A=async()=>{if(!n||!l||l.fileType!=="psc"||!h){r(s=>[...s,"> Error: Script not selected or compiler not set"]);return}F(!0),r(s=>[...s,`> Compiling ${l.name}...`]);try{const s=await n.runPapyrusCompiler(l.path,h);E(s),s.exitCode===0?r(t=>[...t,"[MOSSY] Compilation SUCCESS. The script is now optimized and ready for deployment.","> Output: Papyrus script compiled"]):r(t=>[...t,"[MOSSY] Compilation FAILED. I detected errors in the logic flow.",s.stderr||s.stdout])}catch(s){r(t=>[...t,`> Compilation error: ${s}`])}finally{F(!1)}},B=()=>{if(!i)return;const s=i.substring(0,i.lastIndexOf("\\"));x(s||"D:\\")},_=()=>{x("D:\\")},V=s=>{switch(s){case"psc":return e.jsx(y,{className:"w-4 h-4 text-yellow-500"});case"nif":return e.jsx(v,{className:"w-4 h-4 text-blue-400"});case"dds":return e.jsx(v,{className:"w-4 h-4 text-purple-400"});default:return e.jsx(v,{className:"w-4 h-4 text-slate-400"})}};return e.jsxs("div",{className:"h-full flex flex-col bg-forge-dark text-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"h-14 border-b border-slate-700 bg-forge-panel flex items-center px-4 justify-between shadow-md z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("button",{onClick:_,className:"p-1.5 hover:bg-slate-700 rounded transition-colors",title:"Home directory",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:B,disabled:!i,className:"p-1.5 hover:bg-slate-700 rounded transition-colors disabled:opacity-50",title:"Parent directory",children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx("input",{value:i,onChange:s=>S(s.target.value),onKeyPress:s=>{s.key==="Enter"&&x(i)},className:"flex-1 bg-slate-950 border border-slate-800 rounded px-2 py-1 text-xs text-slate-200",placeholder:"Enter directory path..."}),e.jsx("button",{onClick:()=>x(),disabled:k,className:"px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded text-xs transition-colors disabled:opacity-50",children:k?"Loading...":"Browse"})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("input",{value:h,onChange:s=>I(s.target.value),className:"w-40 bg-slate-950 border border-slate-800 rounded px-2 py-1 text-xs text-slate-200",placeholder:"Compiler path..."}),e.jsxs("button",{onClick:A,disabled:!l||l.fileType!=="psc"||!h||j,className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 text-white rounded text-xs font-bold transition-colors disabled:opacity-50",children:[j?e.jsx(Y,{className:"w-3 h-3 animate-spin"}):e.jsx(W,{className:"w-3 h-3 fill-current"}),j?"Compiling...":"Compile"]}),e.jsxs("button",{onClick:z,disabled:!l,className:"flex items-center gap-1.5 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded text-xs transition-colors disabled:opacity-50",children:[e.jsx(X,{className:"w-3 h-3"})," Save"]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-64 border-r border-slate-700 bg-slate-900/50 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-3 text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-700/50",children:"File Browser"}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-0.5",children:N.length===0?e.jsx("div",{className:"text-xs text-slate-500 p-2",children:"No files loaded. Browse a directory above."}):N.map(s=>{var a;const t=((a=s.type)==null?void 0:a.toLowerCase())==="folder";return e.jsxs("div",{className:`flex items-center gap-2 py-1 px-2 cursor-pointer hover:bg-slate-800 rounded transition-colors ${(l==null?void 0:l.path)===s.path?"bg-slate-800 text-forge-accent":"text-slate-400"}`,onClick:()=>{t?x(s.path):R(s)},children:[t?e.jsx(K,{className:"w-4 h-4 text-emerald-500"}):V(s.fileType),e.jsx("span",{className:"text-xs font-mono truncate",children:s.name})]},s.path)})})]}),e.jsxs("div",{className:"flex-1 flex flex-col bg-slate-900 relative",children:[l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 bg-slate-800 border-b border-slate-700 flex items-center justify-between text-xs",children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.fileType==="psc"?e.jsx(y,{className:"w-4 h-4 text-yellow-500"}):e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono text-slate-300",children:l.name}),e.jsx("span",{className:"text-slate-500 text-[10px]",children:l.path})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex gap-0",children:[e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("textarea",{value:w,onChange:s=>C(s.target.value),className:"flex-1 bg-slate-900 p-4 font-mono text-sm text-slate-300 resize-none focus:outline-none leading-relaxed",spellCheck:!1})}),e.jsxs("div",{className:"w-72 border-l border-slate-700 bg-slate-900 flex flex-col overflow-y-auto",children:[l.fileType==="psc"&&d&&e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Script Deps"}),d.imports.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 mb-1",children:"Imports"}),e.jsx("div",{className:"space-y-0.5",children:d.imports.map(s=>e.jsx("div",{className:"text-[10px] text-slate-400 bg-slate-800 px-2 py-1 rounded font-mono",children:s},s))})]}),d.references.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 mb-1",children:"References"}),e.jsx("div",{className:"space-y-0.5",children:d.references.map(s=>e.jsx("div",{className:"text-[10px] text-slate-400 bg-slate-800 px-2 py-1 rounded font-mono",children:s},s))})]})]}),l.fileType==="dds"&&u&&e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Texture Info"}),e.jsxs("div",{className:"bg-slate-800 rounded p-2 space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Dimensions:"})," ",e.jsxs("span",{className:"text-forge-accent font-bold",children:[u.width,"x",u.height]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Format:"})," ",e.jsx("span",{className:"text-forge-accent font-mono",children:u.format})]})]})]}),l.fileType==="nif"&&f&&e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Mesh Info"}),e.jsxs("div",{className:"bg-slate-800 rounded p-2 space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vertices:"})," ",e.jsx("span",{className:"text-forge-accent font-bold",children:f.vertices})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Triangles:"})," ",e.jsx("span",{className:"text-forge-accent font-bold",children:f.triangles})]}),e.jsx("div",{children:e.jsx("span",{className:"text-slate-500",children:"Materials:"})}),f.materials.map(s=>e.jsx("div",{className:"text-[10px] text-slate-400 font-mono ml-2",children:s},s))]})]}),b&&e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Compilation"}),e.jsx("div",{className:`text-xs p-2 rounded ${b.exitCode===0?"bg-emerald-900/30 text-emerald-300":"bg-red-900/30 text-red-300"}`,children:b.exitCode===0?"Success":"Failed"})]})]})]})]}),!l&&e.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"w-16 h-16 mb-4 opacity-20 mx-auto"}),e.jsx("p",{className:"text-sm",children:"Open a file from the browser to begin editing."})]})}),e.jsx("div",{className:"h-32 bg-black border-t border-slate-700 p-2 font-mono text-xs overflow-y-auto",children:H.map((s,t)=>e.jsx("div",{className:`mb-1 ${s.includes("FAILED")||s.includes("Error")?"text-red-400":s.includes("SUCCESS")?"text-emerald-400":"text-slate-400"}`,children:s},t))})]})]})]})};export{re as default};
