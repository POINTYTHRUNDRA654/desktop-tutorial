import{c as Je,_ as ot,a as Lt,g as Dr,j as g,e as Ii,r as X,W as $n,G as Ni,V as Rn,f as Vt,R as jr,C as $r,X as Rr,L as Ht,A as Ei,h as Fn,t as Pi,i as Ai,k as Ti,l as _i}from"./index-CEqdjNqX.js";import{l as zn,g as Bn}from"./MossyErrorReporter-CZgmcvLs.js";import{B as nn}from"./box-CqrwuAlR.js";import{F as Fr}from"./folder-open-ChFxcFn0.js";import{L as Li}from"./lock-DPhdJk5y.js";import{T as Mi}from"./trash-2-hMnUtzOy.js";import{F as rn}from"./file-text-5HrwYzdb.js";import{T as on}from"./terminal-B8DiE4iy.js";import{L as Un}from"./loader-circle-BzIUkhYW.js";import{M as Oi}from"./mic-DnNdwcpn.js";import{D as Di}from"./database-V2h3OpNj.js";import{G as zr}from"./globe-CgGhV6Zw.js";import{P as ji}from"./play-txtn9UkQ.js";import{S as $i}from"./search-CnzEPZHT.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Fi=Je("bot",Ri);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Vn=Je("circle-stop",zi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],Ui=Je("leaf",Bi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Hi=Je("paperclip",Vi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],qi=Je("panels-top-left",Yi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],Ki=Je("scroll",Wi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ji=Je("send",Gi);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Qi=Je("square",Xi),yn=e=>{if(e.includes("primitive_cube_add")||e.includes("create_cube"))return"MOSSY_CUBE";let t=e;return t.includes("import bpy")||(t=`import bpy
`+t),t},Zi=async(e,t,n)=>{var i,o,a,s,l,u,c,p,f,d,S,I,F,P,U,R,ne,se,N;if((e==="execute_blender_script"||e==="send_blender_shortcut")&&!n.isBlenderLinked)return{error:"**Error:** Blender Link is offline. Please install the 'Mossy Link' add-on from the Bridge page to control Blender."};if(e==="execute_blender_script"){const b=`${yn(t.script)}
# ID: ${Date.now()}`;t.script=b;try{await navigator.clipboard.writeText(`MOSSY_CMD:${b}`)}catch(_){console.error("Clipboard write failed",_)}window.dispatchEvent(new CustomEvent("mossy-blender-command",{detail:{code:b,description:t.description||"Script Execution"}}))}else if(e==="send_blender_shortcut"){try{await navigator.clipboard.writeText('MOSSY_CMD:import bpy; bpy.ops.wm.context_toggle(data_path="space_data.overlay.show_wireframes")')}catch{}window.dispatchEvent(new CustomEvent("mossy-blender-shortcut",{detail:{keys:t.keys,description:t.desc||"Keyboard Input"}}))}await new Promise(y=>setTimeout(y,800));let r="Success";if(e==="launch_tool")try{const y=window.electronAPI||((i=window.electron)==null?void 0:i.api);if(!y)return console.error("[MossyTools] IPC API not available!"),{success:!1,result:"[MOSSY] The system bridge is not initialized. Please restart the application."};const b=await y.getSettings();console.log("[MossyTools] Settings loaded:",b);const _={xedit:"xeditPath",fo4edit:"xeditPath",fo4xedit:"xeditPath",sseedit:"xeditPath",nifskope:"nifSkopePath","creation kit":"creationKitPath",creationkit:"creationKitPath",f4se:"f4sePath","f4se loader":"f4sePath",loot:"lootPath",vortex:"vortexPath","mod organizer":"mo2Path","mod organizer 2":"mo2Path",modorganizer:"mo2Path",mo2:"mo2Path",bodyslide:"bodySlidePath",outfitstudio:"bodySlidePath","body slide":"bodySlidePath","outfit studio":"bodySlidePath","wrye bash":"wryeBashPath",wryebash:"wryeBashPath",gimp:"gimpPath",upscayl:"upscaylPath",photopea:"photopeaPath",shadermap:"shaderMapPath","nvidia texture tools":"nvidiaTextureToolsPath",nvidiaTextureTools:"nvidiaTextureToolsPath","nvidia canvas":"nvidiaCanvasPath",nvidiaCanvas:"nvidiaCanvasPath",canvas:"nvidiaCanvasPath",vita:"nvidiaCanvasPath","vita canvas":"nvidiaCanvasPath","nvidia omniverse":"nvidiaOmniversePath",nvidiaOmniverse:"nvidiaOmniversePath",blender:"blenderPath",bae:"baePath",archive2:"archive2Path","archive 2":"archive2Path",fomodcreator:"fomodCreatorPath","fomod creator":"fomodCreatorPath","autodesk fbx":"autodeskFbxPath","fbx converter":"autodeskFbxPath",photodemon:"photoDemonPath","photo demon":"photoDemonPath",unwrap3:"unWrap3Path","un-wrap3":"unWrap3Path",nifutils:"nifUtilsSuitePath","nif utils":"nifUtilsSuitePath",spin3d:"spin3dPath"},C={xedit:"xEdit",fo4edit:"FO4Edit",fo4xedit:"FO4xEdit",blender:"Blender",nifskope:"NifSkope",creationkit:"Creation Kit",vortex:"Vortex",mo2:"Mod Organizer 2",upscayl:"Upscayl",photopea:"Photopea",shadermap:"ShaderMap",nvidiaTextureTools:"NVIDIA Texture Tools",nvidiaCanvas:"NVIDIA Canvas",canvas:"NVIDIA Canvas",vita:"NVIDIA Canvas","vita canvas":"NVIDIA Canvas","nvidia canvas":"NVIDIA Canvas",nvidiaOmniverse:"NVIDIA Omniverse",omniverse:"NVIDIA Omniverse","nvidia omniverse":"NVIDIA Omniverse",f4se:"F4SE Loader",wryebash:"Wrye Bash",bae:"B.A.E. Archive Extractor",archive2:"Archive2",fomodcreator:"FOMOD Creator","autodesk fbx":"Autodesk FBX Converter",photodemon:"PhotoDemon",unwrap3:"Unwrap3",nifutils:"NifUtils Suite",spin3d:"Spin3D"},v=t.toolId.toLowerCase(),k=_[v]||`${t.toolId}Path`,w=C[v]||t.toolId,T={mo2:["modorganizer","mod organizer","mo2"],xedit:["fo4edit","fo4xedit","sseedit","tes5edit","xedit"],bodyslide:["outfitstudio","bodyslide","body slide"],creationkit:["ck","creation kit","creationkit"],f4se:["f4seloader","f4se","script extender","f4se loader"],vortex:["vortex"],nifskope:["nifskope","nif skope"],wryebash:["wrye bash","wryebash"],bae:["bae","archive extractor","bethesda archive extractor"],archive2:["archive2","archive 2","bethesda archive"],fomodcreator:["fomod creator","fomod"],"autodesk fbx":["autodesk fbx","fbx converter"],photodemon:["photodemon","photo demon"],unwrap3:["unwrap3","un-wrap3"],nifutils:["nifutils","nif utils"],spin3d:["spin3d"],canvas:["nvidia canvas","nvidiacanvas","canvas","vita","vita canvas"],"nvidia canvas":["nvidia canvas","nvidiacanvas","canvas","vita","vita canvas"],nvidiacanvas:["nvidia canvas","nvidiacanvas","canvas","vita","vita canvas"],vita:["nvidia canvas","nvidiacanvas","canvas","vita","vita canvas"],gimp:["gimp","gnu image manipulation program"],blender:["blender"],"nvidia omniverse":["omniverse","nvidia omniverse"],omniverse:["omniverse","nvidia omniverse"]}[v]||[v],D=JSON.parse(localStorage.getItem("mossy_apps")||"[]"),B=b[k]||b[t.toolId];console.log(`
========== [MossyTools] LAUNCH TOOL DEBUG ==========`),console.log(`[MossyTools] Tool requested: "${t.toolId}"`),console.log(`[MossyTools] Settings key to check: "${k}"`),console.log(`[MossyTools] Path from settings: "${B}"`),console.log(`[MossyTools] Explicit path from AI: "${t.path}"`),console.log("[MossyTools] All settings keys:",Object.keys(b)),console.log("[MossyTools] Complete settings object:",b);let z=t.path;if(!z&&B&&B.length>3&&(z=B,console.log(`[MossyTools] âœ… Using MANUAL SETTINGS path: ${z}`)),!z){console.log(`[MossyTools] No manual setting found. Checking auto-detect cache (${D.length} apps)...`);const K=D.find(h=>h.id===t.toolId);if(K&&K.path)z=K.path,console.log(`[MossyTools] âœ… Found EXACT ID match in cache: ${z}`);else{const h=D.filter(me=>{const G=(me.name||"").toLowerCase(),m=(me.displayName||"").toLowerCase(),fe=me.path||"",be=(me.id||"").toLowerCase();return fe&&(T.some(ie=>G.includes(ie)||m.includes(ie))||T.some(ie=>be.includes(ie))||be===v||be===t.toolId.toLowerCase())});if(h.length>0){console.log(`[MossyTools] Found ${h.length} possible matches by alias`);const me=["modorganizer.exe","mo2.exe","fo4edit.exe","xedit.exe","nifskope.exe","creationkit.exe","vortex.exe","f4se_loader.exe","blender.exe"];h.sort((G,m)=>{const fe=(G.path||"").toLowerCase(),be=(m.path||"").toLowerCase(),ie=me.some(Ee=>fe.endsWith(Ee)),$e=me.some(Ee=>be.endsWith(Ee));if(ie&&!$e)return-1;if(!ie&&$e)return 1;const Pe=fe.startsWith("c:"),Ae=be.startsWith("c:");return!Pe&&Ae?-1:Pe&&!Ae?1:0}),z=h[0].path,console.log(`[MossyTools] âœ… Using BEST MATCH from cache: ${z}`)}}}if(console.log(`[MossyTools] ðŸŽ¯ FINAL RESOLVED PATH: ${z}`),console.log(`========== [MossyTools] END DEBUG ==========
`),z){const K=await y.openProgram(z);if(K&&K.success)return{success:!0,result:`[MOSSY] I have successfully launched ${w}.

Location: \`${z}\`
Status: Process Initialized. Directive complete.`};{const h=(K==null?void 0:K.error)||"The system bridge timed out or the executable was blocked.";return{success:!1,result:`[MOSSY] I attempted to launch ${w} at \`${z}\`, but the hardware bridge encountered an error: ${h}. Please verify the folder permissions.`}}}else{console.warn(`[MossyTools] Failed to find path for ${v}. Detected apps:`,D.length);const K=D&&D.length>0;let h="";return v==="canvas"||v==="vita"||v==="nvidiacanvas"||t.toolId.toLowerCase().includes("canvas")?h=`

**âš ï¸ NVIDIA Canvas (Vita Canvas) Not Found**

NVIDIA Canvas requires:
â€¢ NVIDIA RTX GPU (20 series or newer)
â€¢ Installed from: https://www.nvidia.com/en-us/studio/canvas/

Default install location:
\`C:\\Program Files\\NVIDIA Corporation\\NVIDIA Canvas\\NVIDIACanvas.exe\`

**To configure manually:**
1. Go to **External Tools** settings (âš™ï¸)
2. Find **"NVIDIA Canvas (Vita Canvas)"**
3. Click **Browse** and select \`NVIDIACanvas.exe\`
4. Click **Save Settings**

**Not installed?** Download from NVIDIA's website (requires RTX GPU).`:K?h=`

**âš ï¸ ${w} Not Found**

${w} was not found during the system scan. Please manually configure it:

1. Go to **External Tools** settings
2. Click **Browse** next to "${w}"
3. Navigate to your ${w} installation folder
4. Select the main executable (.exe file)
5. Click **Save Settings**`:h=`

**âš ï¸ ACTION REQUIRED:**
Your system hasn't been scanned yet. To use ${w}:

1. Go to the **External Tools** settings (click the wrench icon)
2. Click **Browse** next to "${w}"
3. Find and select the ${w} executable
4. Click **Save Settings**

Alternatively, click **System Scan** in Desktop Bridge to auto-detect all tools.`,{success:!1,result:`[MOSSY] I cannot launch ${w} because I don't know where it's installed.${h}`}}}catch(y){return console.error("[MossyTools] Launch error:",y),{success:!1,result:`[MOSSY] I encountered an error while attempting to initialize ${t.toolId}. Hardware bridge offline.`}}else if(e==="update_tool_path")try{const y=window.electronAPI||((o=window.electron)==null?void 0:o.api),b=await y.getSettings(),_={xedit:"xeditPath",fo4edit:"xeditPath",fo4xedit:"xeditPath",nifskope:"nifSkopePath",creationkit:"creationKitPath",f4se:"f4sePath",loot:"lootPath",vortex:"vortexPath",mo2:"mo2Path",blender:"blenderPath"},C=t.toolId.toLowerCase(),v=_[C]||`${t.toolId}Path`;await y.setSettings({[v]:t.path});const k=JSON.parse(localStorage.getItem("mossy_apps")||"[]"),w=k.findIndex(O=>(O.name||"").toLowerCase().includes(C)||(O.displayName||"").toLowerCase().includes(C));w!==-1?k[w].path=t.path:k.push({id:Math.random().toString(36).substr(2,9),name:t.toolId,displayName:t.toolId,path:t.path,checked:!0,category:"Tool"}),localStorage.setItem("mossy_apps",JSON.stringify(k)),r=`[MOSSY] Corrected. I have updated the neural mapping for ${t.toolId} to: ${t.path}. I will use this path for future execution directives.`}catch(y){r=`[MOSSY] Failed to update tool path: ${y instanceof Error?y.message:"Unknown error"}`}else if(e==="list_files")if(localStorage.getItem("mossy_bridge_active")==="true")try{const b=await fetch("http://127.0.0.1:21337/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t.path||"C:\\"})});if(b.ok){const C=(await b.json()).files.map(v=>`${v.is_dir?"[DIR]":"[FILE]"} ${v.name}`).join(`
`);r=`Files in ${t.path}:
${C||"(Empty Directory)"}`}else r=`Bridge Error: Could not list files in ${t.path}.`}catch{r="Error connecting to bridge for file listing."}else r=`Error: Desktop Bridge is offline. (Unable to list real files in ${t.path})`;else if(e==="generate_papyrus_script")r=`**Papyrus Script Generated:** ${t.scriptName}.psc

\`\`\`papyrus
${t.code}
\`\`\``;else if(e==="check_previs_status")localStorage.getItem("mossy_bridge_active")==="true"?r=`**Scanning Cell ${t.cell}...**

I have verified the PreVis/Precombine data for this cell. 
- Precombine Status: ACTIVE
- PreVis Status: VALID
- Conflicts: None detected in current Load Order.`:r="**Previs Status:** Unable to verify cell integrity. Desktop Bridge is offline. Please launch the 'OmniForge Bridge' to enable real-time cell analysis.";else if(e==="xedit_detect_conflicts"){const y=window.electronAPI||((a=window.electron)==null?void 0:a.api),_=(await y.getSettings()).xeditPath||((s=JSON.parse(localStorage.getItem("mossy_apps")||"[]").find(C=>{var v,k;return(((v=C.name)==null?void 0:v.toLowerCase().includes("edit"))||((k=C.displayName)==null?void 0:k.toLowerCase().includes("edit")))&&C.path}))==null?void 0:s.path);if(_)try{const C=await y.openProgram(_);C&&C.success===!1?r=`[MOSSY] Failed to launch xEdit for conflict detection: ${C.error||"Unknown error"}`:r=`[MOSSY] I have initiated xEdit for conflict detection at ${_}. Please check the 'Messages' tab in xEdit for the results. I will monitor for any exported log files.`}catch(C){r=`[MOSSY] Failed to launch xEdit: ${C instanceof Error?C.message:"Unknown error"}`}else r="[MOSSY] I cannot run conflict detection because xEdit is not configured. Please link it in the External Tools module."}else if(e==="xedit_clean_masters"){const y=window.electronAPI||((l=window.electron)==null?void 0:l.api),_=(await y.getSettings()).xeditPath||((u=JSON.parse(localStorage.getItem("mossy_apps")||"[]").find(C=>{var v,k;return(((v=C.name)==null?void 0:v.toLowerCase().includes("edit"))||((k=C.displayName)==null?void 0:k.toLowerCase().includes("edit")))&&C.path}))==null?void 0:u.path);if(_)try{const C=await y.openProgram(_);C&&C.success===!1?r=`[MOSSY] Failed to launch xEdit in cleaning mode: ${C.error||"Unknown error"}`:r=`[MOSSY] I have launched xEdit in Cleaning Mode from ${_}. Follow the on-screen instructions to clean ITM and UDR records from your active plugin.`}catch(C){r=`[MOSSY] Failed to launch xEdit in cleaning mode: ${C instanceof Error?C.message:"Unknown error"}`}else r="[MOSSY] I cannot initiate cleaning because xEdit is not found."}else if(e==="control_interface")window.dispatchEvent(new CustomEvent("mossy-control",{detail:{action:t.action,payload:{path:t.target}}})),r=`Navigating to ${t.target}`;else if(e==="launch_program")try{const y=t.programName,b=t.reason||"Opening requested tool";console.log(`[MOSSY LAUNCH] Attempting to launch: "${y}"`),console.log(`[MOSSY LAUNCH] Reason: ${b}`);const _=window.electronAPI||((c=window.electron)==null?void 0:c.api);let C=null,v=null;if(_)try{const w=await _.getSettings(),O=y.toLowerCase().trim(),D=(K=>K.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase())(O),B={canvas:{key:"nvidiaCanvasPath",displayName:"NVIDIA Canvas"},"nvidia canvas":{key:"nvidiaCanvasPath",displayName:"NVIDIA Canvas"},nvidiacanvas:{key:"nvidiaCanvasPath",displayName:"NVIDIA Canvas"},vita:{key:"nvidiaCanvasPath",displayName:"NVIDIA Canvas"},"vita canvas":{key:"nvidiaCanvasPath",displayName:"NVIDIA Canvas"},omniverse:{key:"nvidiaOmniversePath",displayName:"NVIDIA Omniverse"},"nvidia omniverse":{key:"nvidiaOmniversePath",displayName:"NVIDIA Omniverse"},"nvidia texture tools":{key:"nvidiaTextureToolsPath",displayName:"NVIDIA Texture Tools"},nvidiatexturetools:{key:"nvidiaTextureToolsPath",displayName:"NVIDIA Texture Tools"},"texture tools":{key:"nvidiaTextureToolsPath",displayName:"NVIDIA Texture Tools"},"texture exporter":{key:"nvidiaTextureToolsPath",displayName:"NVIDIA Texture Tools"},xedit:{key:"xeditPath",displayName:"xEdit"},fo4edit:{key:"xeditPath",displayName:"FO4Edit"},fo4xedit:{key:"xeditPath",displayName:"FO4xEdit"},edit:{key:"xeditPath",displayName:"xEdit"},nifskope:{key:"nifSkopePath",displayName:"NifSkope"},"nif skope":{key:"nifSkopePath",displayName:"NifSkope"},"creation kit":{key:"creationKitPath",displayName:"Creation Kit"},creationkit:{key:"creationKitPath",displayName:"Creation Kit"},ck:{key:"creationKitPath",displayName:"Creation Kit"},vortex:{key:"vortexPath",displayName:"Vortex"},"mod organizer":{key:"mo2Path",displayName:"Mod Organizer 2"},"mod organizer 2":{key:"mo2Path",displayName:"Mod Organizer 2"},mo2:{key:"mo2Path",displayName:"Mod Organizer 2"},modorganizer:{key:"mo2Path",displayName:"Mod Organizer 2"},loot:{key:"lootPath",displayName:"LOOT"},blender:{key:"blenderPath",displayName:"Blender"},gimp:{key:"gimpPath",displayName:"GIMP"},photopea:{key:"photopeaPath",displayName:"Photopea"},upscayl:{key:"upscaylPath",displayName:"Upscayl"},shadermap:{key:"shaderMapPath",displayName:"ShaderMap"},"shader map":{key:"shaderMapPath",displayName:"ShaderMap"},bodyslide:{key:"bodySlidePath",displayName:"BodySlide"},"body slide":{key:"bodySlidePath",displayName:"BodySlide"},"outfit studio":{key:"bodySlidePath",displayName:"Outfit Studio"},outfitstudio:{key:"bodySlidePath",displayName:"Outfit Studio"},"wrye bash":{key:"wryeBashPath",displayName:"Wrye Bash"},wryebash:{key:"wryeBashPath",displayName:"Wrye Bash"},bae:{key:"baePath",displayName:"B.A.E."},"archive extractor":{key:"baePath",displayName:"B.A.E."},archive2:{key:"archive2Path",displayName:"Archive2"},"archive 2":{key:"archive2Path",displayName:"Archive 2"},"fomod creator":{key:"fomodCreatorPath",displayName:"FOMOD Creator"},fomodcreator:{key:"fomodCreatorPath",displayName:"FOMOD Creator"},fomod:{key:"fomodCreatorPath",displayName:"FOMOD Creator"},"autodesk fbx":{key:"autodeskFbxPath",displayName:"Autodesk FBX Converter"},"fbx converter":{key:"autodeskFbxPath",displayName:"Autodesk FBX Converter"},fbx:{key:"autodeskFbxPath",displayName:"Autodesk FBX Converter"},photodemon:{key:"photoDemonPath",displayName:"PhotoDemon"},"photo demon":{key:"photoDemonPath",displayName:"PhotoDemon"},unwrap3:{key:"unWrap3Path",displayName:"Unwrap3"},"un-wrap3":{key:"unWrap3Path",displayName:"Unwrap3"},nifutils:{key:"nifUtilsSuitePath",displayName:"NifUtils Suite"},"nif utils":{key:"nifUtilsSuitePath",displayName:"NifUtils Suite"},spin3d:{key:"spin3dPath",displayName:"Spin3D"},"spin 3d":{key:"spin3dPath",displayName:"Spin3D"},f4se:{key:"f4sePath",displayName:"F4SE Loader"},"f4se loader":{key:"f4sePath",displayName:"F4SE Loader"}};let z=B[O]||B[D];if(z){const K=w[z.key];K&&K.length>3&&(C=z.displayName,v=K,console.log(`[MOSSY LAUNCH] âœ“ Found in settings: ${C} -> ${v}`))}}catch(w){console.warn("[MOSSY LAUNCH] Settings check failed:",w)}if(v&&(_!=null&&_.openProgram))try{return console.log(`[MOSSY LAUNCH] Launching from settings: ${v}`),console.log("[MOSSY LAUNCH] Path exists check..."),await _.openProgram(v),console.log("[MOSSY LAUNCH] âœ“ Program launch command sent successfully"),r=`[MOSSY] âœ… Launched **${C}**

${b}

The program should open in a few seconds.`,{success:!0,result:r}}catch(w){console.error("[MOSSY LAUNCH] Settings launch failed:",w);const O=w instanceof Error?w.message:String(w);return r=`[MOSSY] âš ï¸ Could not launch **${C}**

**Error:** ${O}

**Path:** ${v}

Please check the path in External Tools settings.`,{success:!1,result:r}}const k=JSON.parse(localStorage.getItem("mossy_all_detected_apps")||"[]");if(k.length===0)r="[MOSSY] No programs detected yet. Please run a system scan first via System Monitor â†’ Hardware â†’ Detect Hardware.";else{const w=y.toLowerCase().trim(),O=k.map(T=>{const D=(T.displayName||T.name||"").toLowerCase();let B=0;return D===w?B=1e3:D.endsWith(w)||D.split(" ").some(z=>z===w)?B=800:D.startsWith(w)?B=600:D.split(" ").some(z=>z.includes(w))||D.split("-").some(z=>z.includes(w))?B=400:D.includes(w)&&(B=100),{app:T,score:B}}).filter(T=>T.score>0).sort((T,D)=>D.score-T.score);if(console.log(`[MOSSY LAUNCH] Scored matches for "${y}":`,O.slice(0,3).map(T=>({name:T.app.displayName,score:T.score}))),O.length===0)r=`[MOSSY] Could not find "${y}" in detected programs. Try asking me "what tools do I have?" to see available programs.`;else{const T=O[0].app,D=T.path;console.log(`[MOSSY LAUNCH] Launching: ${T.displayName||T.name}`),console.log(`[MOSSY LAUNCH] Path: ${D}`);const B=((f=(p=window.electron)==null?void 0:p.api)==null?void 0:f.openProgram)||((d=window.electronAPI)==null?void 0:d.openProgram);if(console.log("[MOSSY LAUNCH] Checking API availability..."),console.log("[MOSSY LAUNCH] window.electron exists?",!!window.electron),console.log("[MOSSY LAUNCH] window.electron.api exists?",!!((S=window.electron)!=null&&S.api)),console.log("[MOSSY LAUNCH] openProgram exists?",!!B),B)try{console.log("[MOSSY LAUNCH] Calling openProgram..."),await B(D),console.log("[MOSSY LAUNCH] openProgram call succeeded"),r=`[MOSSY] âœ… Launched **${T.displayName||T.name}**

${b}

The program should open in a few seconds.`}catch(z){console.error("[MOSSY LAUNCH] Launch failed:",z),r=`[MOSSY] âš ï¸ Could not launch "${T.displayName||T.name}". Error: ${z}`}else console.error("[MOSSY LAUNCH] Launch API not available!"),console.error("[MOSSY LAUNCH] Window object keys:",Object.keys(window).filter(z=>z.includes("electron"))),r=`[MOSSY] âš ï¸ Launch capability not available. Found "${T.displayName||T.name}" at:
${D}

Please open it manually.`;if(O.length>1&&O[0].score>=600){const z=O.slice(1,3);z.some(K=>K.score>=400)&&console.log("[MOSSY LAUNCH] Other close matches:",z.map(K=>({name:K.app.displayName,score:K.score})))}}}}catch(y){console.error("[MOSSY LAUNCH] Error:",y),r=`Error launching program: ${y}`}else if(e==="scan_hardware")try{console.log("[MOSSY SCAN] Starting universal program scan...");const y=localStorage.getItem("mossy_last_scan"),b=localStorage.getItem("mossy_all_detected_apps"),_=localStorage.getItem("mossy_scan_summary"),C=y?new Date(y).getTime():0,v=(Date.now()-C)/(1e3*60),k=b&&v<10;console.log("[MOSSY SCAN] Last scan was",v.toFixed(1),"minutes ago"),console.log("[MOSSY SCAN] Using cached results?",k);let w=[],O=null;if(k)console.log("[MOSSY SCAN] âœ“ Using cached scan results (fresh)"),w=JSON.parse(b),O=JSON.parse(_||"{}").systemInfo,r=`[MOSSY] ðŸ”„ **USING CACHED SYSTEM ANALYSIS** (${v.toFixed(1)} min old)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š **DETECTION SUMMARY**
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ“ Total Programs Scanned: **${w.length}**
âœ“ Analysis cached from System Monitor scan
`;else{console.log("[MOSSY SCAN] âš ï¸ Starting DEEP scan (cache is stale or missing)..."),console.log("[MOSSY SCAN] âš ï¸ WARNING: This may take 30-60 seconds and could disconnect Live API!");const T=typeof((F=(I=window.electron)==null?void 0:I.api)==null?void 0:F.detectPrograms)=="function"?window.electron.api.detectPrograms:typeof((P=window.electronAPI)==null?void 0:P.detectPrograms)=="function"?window.electronAPI.detectPrograms:null;if(!T)console.error("[MOSSY SCAN] âŒ detectPrograms function not found"),r="[MOSSY] Scan request received, but hardware detection is not available yet. Please check System Monitor > Hardware to run a scan.";else{console.log("[MOSSY SCAN] âœ“ detectPrograms function found - calling..."),w=await T(),console.log("[MOSSY SCAN] âœ“ detectPrograms returned:",(w==null?void 0:w.length)||0,"programs");try{const D=((R=(U=window.electron)==null?void 0:U.api)==null?void 0:R.getSystemInfo)||((ne=window.electronAPI)==null?void 0:ne.getSystemInfo);D&&(O=await D(),console.log("[MOSSY SCAN] âœ“ System info retrieved"))}catch(D){console.warn("[MOSSY SCAN] âš ï¸ Could not get system info:",D)}try{localStorage.setItem("mossy_all_detected_apps",JSON.stringify(w||[])),localStorage.setItem("mossy_last_scan",new Date().toISOString()),O&&localStorage.setItem("mossy_system_info",JSON.stringify(O)),console.log("[MOSSY SCAN] âœ“ Results cached for future use")}catch(D){console.warn("[MOSSY SCAN] âš ï¸ Storage warning:",D)}}}if(w.length>0){console.log("[MOSSY SCAN] Step 4: Detecting Fallout 4 installations...");const T=["fallout 4","fallout4","fo4"],D=(w||[]).filter(G=>T.some(m=>(G.displayName||G.name||"").toLowerCase().includes(m)));console.log("[MOSSY SCAN] Step 5: Detecting AI/ML tools...");const B=["nvidia","geforce","cuda","rtx","physx","nsight","nvcontainer"],z=(w||[]).filter(G=>{const m=(G.displayName||G.name||"").toLowerCase(),fe=(G.path||"").toLowerCase();return B.some(be=>m.includes(be)||fe.includes("nvidia"))}),K=["ollama","lm studio","lmstudio","luma","lumaai","comfy","stable diffusion","automatic1111","kobold","jan","gpt4all"],h=(w||[]).filter(G=>{const m=(G.displayName||G.name||"").toLowerCase();return K.some(fe=>m.includes(fe))}),me={totalPrograms:w.length,nvidiaTools:z.length,aiTools:h.length,fallout4Installations:D.length,systemInfo:O,allPrograms:(w||[]).map(G=>({name:G.displayName||G.name,path:G.path,version:G.version,publisher:G.publisher}))};localStorage.setItem("mossy_scan_summary",JSON.stringify(me)),k||(r=`[MOSSY] ðŸ” **SYSTEM SCAN COMPLETE**

ðŸ“Š **TOTALS:** ${w.length} programs | ${z.length} NVIDIA tools | ${h.length} AI tools | ${D.length} FO4 installations
`),O&&(r+=`ðŸ–¥ï¸ **HARDWARE:** ${O.cpu||"CPU"} | ${O.ram||"?"}GB RAM | ${O.gpu||"GPU"}
`),z.length>0&&(r+=`
ðŸŸ¢ **NVIDIA:** ${z.slice(0,5).map(G=>G.displayName||G.name).join(", ")}${z.length>5?` +${z.length-5} more`:""}`),h.length>0&&(r+=`
ðŸŸ£ **AI TOOLS:** ${h.slice(0,5).map(G=>G.displayName||G.name).join(", ")}${h.length>5?` +${h.length-5} more`:""}`),D.length>0&&(r+=`
ðŸŽ® **FALLOUT 4:** ${D.length} installation(s) detected`),r+=`

âœ… **System profile loaded.** Ask me about specific tools or capabilities!`}}catch(y){console.error("[MOSSY SCAN] Error during scan:",y),r=`Error during scan: ${y}`}else if(e==="get_scan_results")try{const y=JSON.parse(localStorage.getItem("mossy_apps")||"[]"),b=localStorage.getItem("mossy_last_scan");if(!y||y.length===0)r=`**No scan results found.** I haven't scanned your system yet. Please ask me to "Run a deep scan" or "Scan my system" to detect installed software.`;else{const _=b?new Date(b).toLocaleString():"Unknown time",C=y.filter(k=>{const w=(k.name||k.displayName||"").toLowerCase();return w.includes("ai")||w.includes("chatgpt")||w.includes("claude")||w.includes("gemini")||w.includes("copilot")||w.includes("gpt")||w.includes("ollama")||w.includes("local")||w.includes("neural")||w.includes("llm")}),v=y.map(k=>`- **${k.name}**${k.version?` (v${k.version})`:""}
  ðŸ“ ${k.path}`).join(`
`);r=`**ðŸ“Š System Scan Results**

**Last Scan:** ${_}
**Total Applications Detected:** ${y.length}

${C.length>0?`**AI & Machine Learning Tools (${C.length}):**
${C.map(k=>`- **${k.name}** ðŸ“ ${k.path}`).join(`
`)}

`:""}**All Detected Applications:**
${v}

I can now integrate with these tools to enhance my capabilities and provide you with seamless workflows. Which of these applications would you like me to help you with?`}}catch(y){r=`**Error retrieving scan results:** ${y instanceof Error?y.message:"Unknown error"}. Please run a fresh scan.`}else if(e==="analyze_detected_programs")try{const y=JSON.parse(localStorage.getItem("mossy_all_detected_apps")||"[]"),b=(t==null?void 0:t.category)||"all",_=(t==null?void 0:t.findUsableFor)||"";if(!y||y.length===0)r='No program database available. Please run a **full system scan** first by asking me to "scan my system" or "detect all my programs".';else{const C=Hn(y);let v=y;b!=="all"&&(v=y.filter(w=>{var O,T;return((T=(O=Hn([w])[0])==null?void 0:O.category)==null?void 0:T.toLowerCase())===b.toLowerCase()})),_&&(v=v.filter(w=>eo(w,_))),r=to(v,b,_,C)}}catch(y){r=`**Error analyzing programs:** ${y instanceof Error?y.message:"Unknown error"}`}else if(e==="scan_installed_tools"){const y=((se=window.electron)==null?void 0:se.api)||window.electronAPI;if(y!=null&&y.detectPrograms)try{const b=await y.detectPrograms(),_=["blender","creation","xedit","fo4edit","fo4xedit","edit","vortex","organizer","loot","nifskope","upscayl","bodyslide","f4se","nv","texture","photo","shader","fbx"],C=JSON.parse(localStorage.getItem("mossy_apps")||"[]"),v=b.filter(w=>_.some(O=>w.displayName.toLowerCase().includes(O))).map(w=>({id:`scan-${Math.random().toString(36).substr(2,5)}`,name:w.displayName,displayName:w.displayName,path:w.path,version:w.version,checked:!0,category:"Tool"})),k=[...C];v.forEach(w=>{const O=k.findIndex(T=>T.path===w.path||T.displayName===w.displayName||T.name===w.name);if(O===-1)k.push(w);else{const T=w.path&&!w.path.toLowerCase().startsWith("c:"),D=k[O].path&&k[O].path.toLowerCase().startsWith("c:");T&&D?k[O]={...k[O],...w}:k[O]={...k[O],...w,id:k[O].id}}}),localStorage.setItem("mossy_apps",JSON.stringify(k)),r=`[MOSSY] Deep scan of system drives complete. I have identified and synchronized ${v.length} modding-related applications. Total database size: ${k.length} entries.
Detected Tools:
${v.map(w=>`- ${w.displayName}`).join(`
`)}

I now have the precise execution paths for these tools saved in my neural cache.`}catch(b){const C=await zn("scan_installed_tools",b,{detectProgramsAvailable:!!(y!=null&&y.detectPrograms)},"User requested deep system scan","Verify Electron IPC bridge and detectPrograms function");r=Bn("scan_installed_tools",C.filename)}else{const b=await zn("scan_installed_tools","Native program detection API is unavailable",{electronAPIAvailable:!!y},"User requested deep system scan","Ensure electron preload.ts exposes detectPrograms via contextBridge");r=Bn("scan_installed_tools",b.filename)}}else if(e==="get_error_report")try{const y=JSON.parse(localStorage.getItem("mossy_error_logs")||"[]");if(y.length===0)r="**No error logs found.** There haven't been any errors recorded yet. If you encounter an issue, it will be logged here automatically.";else{const b=y[y.length-1],_=y.slice(0,-1);r=`**ðŸ“‹ Error Report (Most Recent)**

**Timestamp:** ${b.timestamp}
**Tool:** ${b.toolName}
**Error Message:** ${b.errorMessage}

${b.suggestedFix?`**Suggested Fix:** ${b.suggestedFix}
`:""}
${b.userAction?`**User Action:** ${b.userAction}
`:""}
${b.context?`**Context Details:**
${Object.entries(b.context).map(([C,v])=>`- ${C}: ${v}`).join(`
`)}
`:""}

${b.errorStack?`**Technical Details (Stack Trace):**
\`\`\`
${b.errorStack.substring(0,500)}
\`\`\`
`:""}

**Total Errors Logged:** ${y.length}
${_.length>0?`**Previous Errors:** ${_.map(C=>`${C.toolName} (${new Date(C.timestamp).toLocaleTimeString()})`).join(", ")}`:""}

**Next Steps:**
1. Review the "Suggested Fix" above
2. Follow the troubleshooting steps provided
3. Go to **Settings > Diagnostic Tools** to verify system APIs
4. Export the full diagnostic report from **Settings > Diagnostic Tools > Export Full Diagnostic Report**
5. Share the diagnostic report with your assistant for detailed analysis`}}catch(y){r=`**Error retrieving logs:** ${y instanceof Error?y.message:"Unknown error"}`}else if(e==="export_error_logs")try{const y=JSON.parse(localStorage.getItem("mossy_error_logs")||"[]");if(console.log("[MOSSY] export_error_logs called, found",y.length,"errors"),y.length===0)r="**No error logs to export.** There haven't been any errors recorded yet.";else{const _=`mossy-error-report-${new Date().toISOString().replace(/[:.]/g,"-")}.txt`;let C=`MOSSY ERROR REPORT
Generated: ${new Date().toLocaleString()}
Total Errors: ${y.length}

================================
LATEST ERROR (MOST RECENT)
================================
`;const v=y[y.length-1];C+=`
Timestamp: ${v.timestamp}
Tool: ${v.toolName}
Error Message: ${v.errorMessage}

Context:
${v.context?Object.entries(v.context).map(([w,O])=>`  ${w}: ${O}`).join(`
`):"  (no context available)"}

Suggested Fix: ${v.suggestedFix||"(see stack trace for details)"}

User Action: ${v.userAction||"(automatic error logging)"}

Stack Trace:
${v.errorStack||"(no stack available)"}
`,y.length>1&&(C+=`
================================
PREVIOUS ERRORS (${y.length-1} total)
================================
`,y.slice(0,-1).forEach((w,O)=>{C+=`
${O+1}. ${w.toolName} at ${w.timestamp}
   Message: ${w.errorMessage}
   Suggested Fix: ${w.suggestedFix||"N/A"}
`})),C+=`

================================
TROUBLESHOOTING STEPS
================================
1. Review the error message and suggested fix above
2. Check the Diagnostic Tools in Settings to verify system APIs
3. If the problem persists, restart the application
4. Check that all required system dependencies are installed
5. Review system logs in the Diagnostic Tools panel

For more help, visit: Settings > Diagnostic Tools > Run Diagnostics
`;const k=((N=window.electron)==null?void 0:N.api)||window.electronAPI;if(k!=null&&k.saveFile)try{console.log("[MOSSY] Calling api.saveFile with:",{filename:_,contentLength:C.length});const w=await k.saveFile(C,_);console.log("[MOSSY] File saved successfully to:",w),r=`**âœ“ Error report saved!** The file has been saved to your **Downloads** folder as **${_}**.

**Report Contents:**
- Latest error with full details
- All previous errors (${y.length-1} additional)
- Suggested fixes and troubleshooting steps
- System context information

You can now review it, share it with support, or keep it for reference.`}catch(w){console.error("[MOSSY] Electron save failed:",w),console.log("[MOSSY] Falling back to browser download");const O=new Blob([C],{type:"text/plain"}),T=URL.createObjectURL(O),D=document.createElement("a");D.href=T,D.download=_,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(T),r=`**âœ“ Error report exported!** The file **${_}** has been saved. You can now review it at your own pace.

**Report Contents:**
- Latest error with full details
- All previous errors (${y.length-1} additional)
- Suggested fixes and troubleshooting steps
- System context information

Check your Downloads folder or the location where files are saved.`}else{const w=new Blob([C],{type:"text/plain"}),O=URL.createObjectURL(w),T=document.createElement("a");T.href=O,T.download=_,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(O),r=`**âœ“ Error report exported!** The file **${_}** has been saved. You can now review it at your own pace.

**Report Contents:**
- Latest error with full details
- All previous errors (${y.length-1} additional)
- Suggested fixes and troubleshooting steps
- System context information

Check your Downloads folder or the location where files are saved.`}}}catch(y){console.error("[MOSSY] export_error_logs caught error:",y),r=`**Export failed:** ${y instanceof Error?y.message:"Unknown error"}. The error logs may still be available in Settings > Privacy Settings > Export Mossy Error Logs.`}else if(e==="execute_blender_script"){localStorage.getItem("mossy_bridge_active");try{(await fetch("http://localhost:21337/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"blender",script:t.script,target:"active_instance"})})).ok?r="[MOSSY] Directive executed. I have successfully transmitted the Python instructions to the Blender Neural Link. The operation is currently being applied to your active workspace.":r="[MOSSY] I attempted to transmit the script to Blender, but the bridge encountered an error. Please ensure Blender is running and the Mossy Link add-on is active."}catch{r="[MOSSY] Connection to the Neural Bridge was interrupted during script transmission. I have copied the code to your clipboard as a fallback."}}else if(e==="send_blender_shortcut")r=`**Blender Shortcut Sent:** ${t.keys}
Command confirmed by bridge.`;else if(e==="ck_execute_command")r=`**CK Command Executed:** ${t.command}
âœ“ Command sent to Creation Kit console${t.context?`
ðŸ“Œ Context: ${t.context}`:""}`;else if(e==="ck_get_formid")localStorage.getItem("mossy_bridge_active")==="true"?r=`**Bridge Connection Active.**
Searching for EditorID: ${t.editorID}...

*System ready for FormID retrieval from active xEdit/CK session.*`:r="**Offline Error:** Cannot retrieve real FormIDs. Please connect the Desktop Bridge.";else if(e==="ck_create_record")r=localStorage.getItem("mossy_bridge_active")==="true"?`**CK Command Sent:** Create ${t.recordType} for '${t.editorID}'.
Properties: ${t.properties}`:`**Offline Error:** Would create ${t.recordType} for '${t.editorID}'. (Connect bridge for actual CK interaction).`;else if(e==="ck_edit_record")r=localStorage.getItem("mossy_bridge_active")==="true"?`**CK Command Sent:** Update '${t.editorID}'.
Changes: ${t.properties}`:`**Offline Error:** Would update '${t.editorID}'. (Connect bridge for actual CK interaction).`;else if(e==="ck_duplicate_record")localStorage.getItem("mossy_bridge_active")==="true"?r=`**CK Command Sent:** Duplicate '${t.editorID}'.
Checking for result...`:r="**Offline Error:** Connect bridge to duplicate records in the Creation Kit.";else if(e==="ck_list_selected")localStorage.getItem("mossy_bridge_active")==="true"?r=`**Scanning CK Memory...**
No objects currently selected in the active render window. (Ensure CK is the focused window).`:r="**Offline Error:** No live CK selection data available.";else if(e==="ck_set_render_mode")r=`**CK Render Mode set to:** ${t.mode}`;else if(e==="create_mod_project"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{const b=y.createModProject({name:t.name,description:t.description,type:t.type,author:t.author});y.setCurrentMod(b.id),r=`âœ… **Mod Project Created: "${b.name}"**

Your new ${t.type} mod is ready to track!

**Project Details:**
- ID: ${b.id}
- Type: ${t.type}
- Author: ${t.author}
- Version: ${b.version}

You can now add steps to plan and track your progress. Use 'add_mod_step' to get started!`}catch(b){r=`âŒ Error creating mod project: ${b}`}}else if(e==="add_mod_step"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{const b=y.addStep(t.projectId,{title:t.title,description:t.description,priority:t.priority||"medium",estimatedHours:t.estimatedHours});b?r=`âœ… **Step Added: "${b.title}"**

- Priority: ${b.priority}
- Status: pending
${t.estimatedHours?`- Estimated: ${t.estimatedHours} hours
`:""}
You can update the status as you work on this step.`:r="âŒ Project not found. Make sure you created a mod project first."}catch(b){r=`âŒ Error adding step: ${b}`}}else if(e==="update_mod_step"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{const b=y.updateStep(t.projectId,t.stepId,{status:t.status,notes:t.notes,actualHours:t.actualHours});b?r=`âœ… **Step Updated: "${b.title}"**

- New Status: ${b.status}
${t.notes?`- Notes: ${t.notes}
`:""}${t.actualHours?`- Actual Hours: ${t.actualHours}
`:""}`:r="âŒ Step or project not found."}catch(b){r=`âŒ Error updating step: ${b}`}}else if(e==="get_mod_status"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{const b=t.projectId||y.getCurrentModId();if(!b)r="âŒ No mod project selected. Create a project first using 'create_mod_project'.";else{const _=y.getProject(b),C=y.getProjectStats(b);!_||!C?r="âŒ Project not found.":r=`ðŸ“Š **${_.name} - Project Status**

**Progress:** ${_.completionPercentage}% complete
**Status:** ${_.status}
**Version:** ${_.version}

**Steps:**
- Total: ${C.totalSteps}
- Completed: ${C.completedSteps}
- In Progress: ${C.inProgressSteps}
- Pending: ${C.pendingSteps}
- Blocked: ${C.blockedSteps}

**Time:**
- Estimated: ${Math.round(C.totalEstimatedHours)} hours
- Actual: ${Math.round(C.totalActualHours)} hours`}}catch(b){r=`âŒ Error fetching mod status: ${b}`}}else if(e==="list_mod_projects"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{const b=y.getProjectListItems();b.length===0?r="ðŸ“¦ **No mod projects yet.** Use 'create_mod_project' to start your first mod!":r=`ðŸ“¦ **Your Mod Projects:**

${b.map(C=>`â€¢ **${C.name}** (${C.type}) - v${C.version}
  Status: ${C.status} | Progress: ${C.completionPercentage}% | Steps: ${C.completedStepCount}/${C.stepCount}`).join(`
`)}`}catch(b){r=`âŒ Error listing projects: ${b}`}}else if(e==="set_current_mod"){const{ModProjectStorage:y}=await ot(async()=>{const{ModProjectStorage:b}=await import("./ModProjectStorage-B07FRDUz.js");return{ModProjectStorage:b}},[],import.meta.url);try{if(!y.setCurrentMod(t.projectId))r="âŒ Project not found.";else{const _=y.getProject(t.projectId);r=`âœ… **Active Mod Set: "${_==null?void 0:_.name}"**

I'll now provide context-aware advice for this mod. Use 'add_mod_step' to continue planning.`}}catch(b){r=`âŒ Error setting current mod: ${b}`}}return{result:r}};function Hn(e){const t={"3D Modeling":["blender","maya","3dsmax","cinema4d","zbrush","sculptris","fusion360","3d"],"Texture Editing":["photoshop","gimp","krita","clip studio","substance","affinity","paint","texturing"],"Mesh Tools":["meshlab","meshmixer","simplify3d","nifskope","nif"],"Modding Tools":["xedit","tes5edit","fo4edit","fo4xedit","creation kit","creationkit","loot","wrye bash","bodyslide","outfit studio"],"Mod Managers":["vortex","modorganizer","mo2","nmm","fomm"],Scripting:["python","visual studio","vscode","sublime","notepad++","atom","code editor","ide"],Media:["premiere","davinci","ffmpeg","handbrake","audacity","video","audio","media"],"AI & ML":["chatgpt","claude","gemini","copilot","ollama","neural","ai","llm","tensorflow","pytorch"],Utilities:["7zip","winrar","total commander","everything","cleanup","optimization"]};return e.map(n=>{const r=(n.displayName||n.name||"").toLowerCase();let i="Other";for(const[o,a]of Object.entries(t))if(a.some(s=>r.includes(s))){i=o;break}return{...n,category:i}})}function eo(e,t){const n=(e.displayName||e.name||"").toLowerCase(),r=t.toLowerCase(),i={texture:["photoshop","gimp","krita","substance","texture","paint","affinity"],"3d modeling":["blender","maya","3dsmax","cinema4d","3d"],mesh:["blender","meshlab","nifskope","mesh"],"weight painting":["blender","bodyslide","outfit"],scripting:["python","visual studio","vscode","code","editor","ide"],modding:["xedit","tes5","fo4edit","creation kit","loot","wrye"],"mod management":["vortex","organizer","nmm"],compression:["7zip","winrar","archive"],video:["premiere","davinci","ffmpeg","handbrake"],audio:["audacity","reaper","ableton"]};for(const[o,a]of Object.entries(i))if(r.includes(o))return a.some(s=>n.includes(s));return n.includes(r)}function to(e,t,n,r){if(e.length===0)return n?`âŒ **No programs found** that could be used for "${n}". Your current setup doesn't have a tool for this, but I can recommend one!`:`âŒ **No programs found** in the "${t}" category.`;const i=r.reduce((a,s)=>(a[s.category]||(a[s.category]=[]),a[s.category].push(s),a),{});let o=`âœ… **Program Analysis Complete - ${e.length} Tools Found**

`;return n?(o+=`**ðŸŽ¯ Tools for "${n}":**

`,e.forEach(a=>{o+=`- **${a.displayName||a.name}**${a.version?` (v${a.version})`:""}
  ðŸ“ ${a.path}
`})):t!=="all"?(o+=`**Category: ${t}**

`,e.forEach(a=>{o+=`- **${a.displayName||a.name}**${a.version?` (v${a.version})`:""}
`})):(o+=`**ðŸ“Š All Programs by Category:**

`,Object.entries(i).forEach(([a,s])=>{o+=`**${a}** (${s.length})
`,s.slice(0,5).forEach(l=>{o+=`  - ${l.displayName||l.name}
`}),s.length>5&&(o+=`  ... and ${s.length-5} more
`),o+=`
`})),o+=`
ðŸ’¡ **Integration Tips:**
`,e.some(a=>(a.displayName||a.name).toLowerCase().includes("blender"))&&(o+=`- Use **Blender** for 3D asset creation and weight painting
`),e.some(a=>(a.displayName||a.name).toLowerCase().includes("xedit")||(a.displayName||a.name).toLowerCase().includes("fo4edit"))&&(o+=`- Use **xEdit/FO4Edit** for modifying ESPs and handling conflicts
`),e.some(a=>(a.displayName||a.name).toLowerCase().includes("photoshop")||(a.displayName||a.name).toLowerCase().includes("gimp")||(a.displayName||a.name).toLowerCase().includes("krita"))&&(o+=`- Use your image editor for texture creation and enhancement
`),e.some(a=>(a.displayName||a.name).toLowerCase().includes("vortex")||(a.displayName||a.name).toLowerCase().includes("organizer"))&&(o+=`- Use your mod manager to test and organize your mods
`),o}function no(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const ro=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,io=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,oo={};function Yn(e,t){return(oo.jsx?io:ro).test(e)}const ao=/[ \t\n\f\r]/g;function so(e){return typeof e=="object"?e.type==="text"?qn(e.value):!1:qn(e)}function qn(e){return e.replace(ao,"")===""}class wt{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}wt.prototype.normal={};wt.prototype.property={};wt.prototype.space=void 0;function Br(e,t){const n={},r={};for(const i of e)Object.assign(n,i.property),Object.assign(r,i.normal);return new wt(n,r,t)}function an(e){return e.toLowerCase()}class Me{constructor(t,n){this.attribute=n,this.property=t}}Me.prototype.attribute="";Me.prototype.booleanish=!1;Me.prototype.boolean=!1;Me.prototype.commaOrSpaceSeparated=!1;Me.prototype.commaSeparated=!1;Me.prototype.defined=!1;Me.prototype.mustUseProperty=!1;Me.prototype.number=!1;Me.prototype.overloadedBoolean=!1;Me.prototype.property="";Me.prototype.spaceSeparated=!1;Me.prototype.space=void 0;let lo=0;const q=tt(),ke=tt(),sn=tt(),A=tt(),pe=tt(),st=tt(),De=tt();function tt(){return 2**++lo}const ln=Object.freeze(Object.defineProperty({__proto__:null,boolean:q,booleanish:ke,commaOrSpaceSeparated:De,commaSeparated:st,number:A,overloadedBoolean:sn,spaceSeparated:pe},Symbol.toStringTag,{value:"Module"})),Yt=Object.keys(ln);class xn extends Me{constructor(t,n,r,i){let o=-1;if(super(t,n),Wn(this,"space",i),typeof r=="number")for(;++o<Yt.length;){const a=Yt[o];Wn(this,Yt[o],(r&ln[a])===ln[a])}}}xn.prototype.defined=!0;function Wn(e,t,n){n&&(e[t]=n)}function ct(e){const t={},n={};for(const[r,i]of Object.entries(e.properties)){const o=new xn(r,e.transform(e.attributes||{},r),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),t[r]=o,n[an(r)]=r,n[an(o.attribute)]=r}return new wt(t,n,e.space)}const Ur=ct({properties:{ariaActiveDescendant:null,ariaAtomic:ke,ariaAutoComplete:null,ariaBusy:ke,ariaChecked:ke,ariaColCount:A,ariaColIndex:A,ariaColSpan:A,ariaControls:pe,ariaCurrent:null,ariaDescribedBy:pe,ariaDetails:null,ariaDisabled:ke,ariaDropEffect:pe,ariaErrorMessage:null,ariaExpanded:ke,ariaFlowTo:pe,ariaGrabbed:ke,ariaHasPopup:null,ariaHidden:ke,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:pe,ariaLevel:A,ariaLive:null,ariaModal:ke,ariaMultiLine:ke,ariaMultiSelectable:ke,ariaOrientation:null,ariaOwns:pe,ariaPlaceholder:null,ariaPosInSet:A,ariaPressed:ke,ariaReadOnly:ke,ariaRelevant:null,ariaRequired:ke,ariaRoleDescription:pe,ariaRowCount:A,ariaRowIndex:A,ariaRowSpan:A,ariaSelected:ke,ariaSetSize:A,ariaSort:null,ariaValueMax:A,ariaValueMin:A,ariaValueNow:A,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function Vr(e,t){return t in e?e[t]:t}function Hr(e,t){return Vr(e,t.toLowerCase())}const co=ct({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:st,acceptCharset:pe,accessKey:pe,action:null,allow:null,allowFullScreen:q,allowPaymentRequest:q,allowUserMedia:q,alt:null,as:null,async:q,autoCapitalize:null,autoComplete:pe,autoFocus:q,autoPlay:q,blocking:pe,capture:null,charSet:null,checked:q,cite:null,className:pe,cols:A,colSpan:null,content:null,contentEditable:ke,controls:q,controlsList:pe,coords:A|st,crossOrigin:null,data:null,dateTime:null,decoding:null,default:q,defer:q,dir:null,dirName:null,disabled:q,download:sn,draggable:ke,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:q,formTarget:null,headers:pe,height:A,hidden:sn,high:A,href:null,hrefLang:null,htmlFor:pe,httpEquiv:pe,id:null,imageSizes:null,imageSrcSet:null,inert:q,inputMode:null,integrity:null,is:null,isMap:q,itemId:null,itemProp:pe,itemRef:pe,itemScope:q,itemType:pe,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:q,low:A,manifest:null,max:null,maxLength:A,media:null,method:null,min:null,minLength:A,multiple:q,muted:q,name:null,nonce:null,noModule:q,noValidate:q,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:q,optimum:A,pattern:null,ping:pe,placeholder:null,playsInline:q,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:q,referrerPolicy:null,rel:pe,required:q,reversed:q,rows:A,rowSpan:A,sandbox:pe,scope:null,scoped:q,seamless:q,selected:q,shadowRootClonable:q,shadowRootDelegatesFocus:q,shadowRootMode:null,shape:null,size:A,sizes:null,slot:null,span:A,spellCheck:ke,src:null,srcDoc:null,srcLang:null,srcSet:null,start:A,step:null,style:null,tabIndex:A,target:null,title:null,translate:null,type:null,typeMustMatch:q,useMap:null,value:ke,width:A,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:pe,axis:null,background:null,bgColor:null,border:A,borderColor:null,bottomMargin:A,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:q,declare:q,event:null,face:null,frame:null,frameBorder:null,hSpace:A,leftMargin:A,link:null,longDesc:null,lowSrc:null,marginHeight:A,marginWidth:A,noResize:q,noHref:q,noShade:q,noWrap:q,object:null,profile:null,prompt:null,rev:null,rightMargin:A,rules:null,scheme:null,scrolling:ke,standby:null,summary:null,text:null,topMargin:A,valueType:null,version:null,vAlign:null,vLink:null,vSpace:A,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:q,disableRemotePlayback:q,prefix:null,property:null,results:A,security:null,unselectable:null},space:"html",transform:Hr}),uo=ct({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:De,accentHeight:A,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:A,amplitude:A,arabicForm:null,ascent:A,attributeName:null,attributeType:null,azimuth:A,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:A,by:null,calcMode:null,capHeight:A,className:pe,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:A,diffuseConstant:A,direction:null,display:null,dur:null,divisor:A,dominantBaseline:null,download:q,dx:null,dy:null,edgeMode:null,editable:null,elevation:A,enableBackground:null,end:null,event:null,exponent:A,externalResourcesRequired:null,fill:null,fillOpacity:A,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:st,g2:st,glyphName:st,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:A,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:A,horizOriginX:A,horizOriginY:A,id:null,ideographic:A,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:A,k:A,k1:A,k2:A,k3:A,k4:A,kernelMatrix:De,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:A,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:A,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:A,overlineThickness:A,paintOrder:null,panose1:null,path:null,pathLength:A,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:pe,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:A,pointsAtY:A,pointsAtZ:A,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:De,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:De,rev:De,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:De,requiredFeatures:De,requiredFonts:De,requiredFormats:De,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:A,specularExponent:A,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:A,strikethroughThickness:A,string:null,stroke:null,strokeDashArray:De,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:A,strokeOpacity:A,strokeWidth:null,style:null,surfaceScale:A,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:De,tabIndex:A,tableValues:null,target:null,targetX:A,targetY:A,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:De,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:A,underlineThickness:A,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:A,values:null,vAlphabetic:A,vMathematical:A,vectorEffect:null,vHanging:A,vIdeographic:A,version:null,vertAdvY:A,vertOriginX:A,vertOriginY:A,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:A,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Vr}),Yr=ct({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),qr=ct({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Hr}),Wr=ct({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),po={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},ho=/[A-Z]/g,Kn=/-[a-z]/g,mo=/^data[-\w.:]+$/i;function fo(e,t){const n=an(t);let r=t,i=Me;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&mo.test(t)){if(t.charAt(4)==="-"){const o=t.slice(5).replace(Kn,yo);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=t.slice(4);if(!Kn.test(o)){let a=o.replace(ho,go);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}i=xn}return new i(r,t)}function go(e){return"-"+e.toLowerCase()}function yo(e){return e.charAt(1).toUpperCase()}const xo=Br([Ur,co,Yr,qr,Wr],"html"),bn=Br([Ur,uo,Yr,qr,Wr],"svg");function bo(e){return e.join(" ").trim()}var wn={},Gn=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,wo=/\n/g,So=/^\s*/,ko=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,vo=/^:\s*/,Co=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,Io=/^[;\s]*/,No=/^\s+|\s+$/g,Eo=`
`,Jn="/",Xn="*",et="",Po="comment",Ao="declaration";function To(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function i(S){var I=S.match(wo);I&&(n+=I.length);var F=S.lastIndexOf(Eo);r=~F?S.length-F:r+S.length}function o(){var S={line:n,column:r};return function(I){return I.position=new a(S),u(),I}}function a(S){this.start=S,this.end={line:n,column:r},this.source=t.source}a.prototype.content=e;function s(S){var I=new Error(t.source+":"+n+":"+r+": "+S);if(I.reason=S,I.filename=t.source,I.line=n,I.column=r,I.source=e,!t.silent)throw I}function l(S){var I=S.exec(e);if(I){var F=I[0];return i(F),e=e.slice(F.length),I}}function u(){l(So)}function c(S){var I;for(S=S||[];I=p();)I!==!1&&S.push(I);return S}function p(){var S=o();if(!(Jn!=e.charAt(0)||Xn!=e.charAt(1))){for(var I=2;et!=e.charAt(I)&&(Xn!=e.charAt(I)||Jn!=e.charAt(I+1));)++I;if(I+=2,et===e.charAt(I-1))return s("End of comment missing");var F=e.slice(2,I-2);return r+=2,i(F),e=e.slice(I),r+=2,S({type:Po,comment:F})}}function f(){var S=o(),I=l(ko);if(I){if(p(),!l(vo))return s("property missing ':'");var F=l(Co),P=S({type:Ao,property:Qn(I[0].replace(Gn,et)),value:F?Qn(F[0].replace(Gn,et)):et});return l(Io),P}}function d(){var S=[];c(S);for(var I;I=f();)I!==!1&&(S.push(I),c(S));return S}return u(),d()}function Qn(e){return e?e.replace(No,et):et}var _o=To,Lo=Lt&&Lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wn,"__esModule",{value:!0});wn.default=Oo;const Mo=Lo(_o);function Oo(e,t){let n=null;if(!e||typeof e!="string")return n;const r=(0,Mo.default)(e),i=typeof t=="function";return r.forEach(o=>{if(o.type!=="declaration")return;const{property:a,value:s}=o;i?t(a,s,o):s&&(n=n||{},n[a]=s)}),n}var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.camelCase=void 0;var Do=/^--[a-zA-Z0-9_-]+$/,jo=/-([a-z])/g,$o=/^[^-]+$/,Ro=/^-(webkit|moz|ms|o|khtml)-/,Fo=/^-(ms)-/,zo=function(e){return!e||$o.test(e)||Do.test(e)},Bo=function(e,t){return t.toUpperCase()},Zn=function(e,t){return"".concat(t,"-")},Uo=function(e,t){return t===void 0&&(t={}),zo(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(Fo,Zn):e=e.replace(Ro,Zn),e.replace(jo,Bo))};Dt.camelCase=Uo;var Vo=Lt&&Lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ho=Vo(wn),Yo=Dt;function cn(e,t){var n={};return!e||typeof e!="string"||(0,Ho.default)(e,function(r,i){r&&i&&(n[(0,Yo.camelCase)(r,t)]=i)}),n}cn.default=cn;var qo=cn;const Wo=Dr(qo),Kr=Gr("end"),Sn=Gr("start");function Gr(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function Ko(e){const t=Sn(e),n=Kr(e);if(t&&n)return{start:t,end:n}}function gt(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?er(e.position):"start"in e||"end"in e?er(e):"line"in e||"column"in e?un(e):""}function un(e){return tr(e&&e.line)+":"+tr(e&&e.column)}function er(e){return un(e&&e.start)+"-"+un(e&&e.end)}function tr(e){return e&&typeof e=="number"?e:1}class Ne extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",o={},a=!1;if(n&&("line"in n&&"column"in n?o={place:n}:"start"in n&&"end"in n?o={place:n}:"type"in n?o={ancestors:[n],place:n.position}:o={...n}),typeof t=="string"?i=t:!o.cause&&t&&(a=!0,i=t.message,o.cause=t),!o.ruleId&&!o.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?o.ruleId=r:(o.source=r.slice(0,l),o.ruleId=r.slice(l+1))}if(!o.place&&o.ancestors&&o.ancestors){const l=o.ancestors[o.ancestors.length-1];l&&(o.place=l.position)}const s=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=s?s.line:void 0,this.name=gt(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=a&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ne.prototype.file="";Ne.prototype.name="";Ne.prototype.reason="";Ne.prototype.message="";Ne.prototype.stack="";Ne.prototype.column=void 0;Ne.prototype.line=void 0;Ne.prototype.ancestors=void 0;Ne.prototype.cause=void 0;Ne.prototype.fatal=void 0;Ne.prototype.place=void 0;Ne.prototype.ruleId=void 0;Ne.prototype.source=void 0;const kn={}.hasOwnProperty,Go=new Map,Jo=/[A-Z]/g,Xo=new Set(["table","tbody","thead","tfoot","tr"]),Qo=new Set(["td","th"]),Jr="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Zo(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=sa(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=aa(n,t.jsx,t.jsxs)}const i={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?bn:xo,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},o=Xr(i,e,void 0);return o&&typeof o!="string"?o:i.create(e,i.Fragment,{children:o||void 0},void 0)}function Xr(e,t,n){if(t.type==="element")return ea(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return ta(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return ra(e,t,n);if(t.type==="mdxjsEsm")return na(e,t);if(t.type==="root")return ia(e,t,n);if(t.type==="text")return oa(e,t)}function ea(e,t,n){const r=e.schema;let i=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=bn,e.schema=i),e.ancestors.push(t);const o=Zr(e,t.tagName,!1),a=la(e,t);let s=Cn(e,t);return Xo.has(t.tagName)&&(s=s.filter(function(l){return typeof l=="string"?!so(l):!0})),Qr(e,a,o,t),vn(a,s),e.ancestors.pop(),e.schema=r,e.create(t,o,a,n)}function ta(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}bt(e,t.position)}function na(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);bt(e,t.position)}function ra(e,t,n){const r=e.schema;let i=r;t.name==="svg"&&r.space==="html"&&(i=bn,e.schema=i),e.ancestors.push(t);const o=t.name===null?e.Fragment:Zr(e,t.name,!0),a=ca(e,t),s=Cn(e,t);return Qr(e,a,o,t),vn(a,s),e.ancestors.pop(),e.schema=r,e.create(t,o,a,n)}function ia(e,t,n){const r={};return vn(r,Cn(e,t)),e.create(t,e.Fragment,r,n)}function oa(e,t){return t.value}function Qr(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function vn(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function aa(e,t,n){return r;function r(i,o,a,s){const u=Array.isArray(a.children)?n:t;return s?u(o,a,s):u(o,a)}}function sa(e,t){return n;function n(r,i,o,a){const s=Array.isArray(o.children),l=Sn(r);return t(i,o,a,s,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function la(e,t){const n={};let r,i;for(i in t.properties)if(i!=="children"&&kn.call(t.properties,i)){const o=ua(e,i,t.properties[i]);if(o){const[a,s]=o;e.tableCellAlignToStyle&&a==="align"&&typeof s=="string"&&Qo.has(t.tagName)?r=s:n[a]=s}}if(r){const o=n.style||(n.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function ca(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const a=o.expression;a.type;const s=a.properties[0];s.type,Object.assign(n,e.evaluater.evaluateExpression(s.argument))}else bt(e,t.position);else{const i=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const s=r.value.data.estree.body[0];s.type,o=e.evaluater.evaluateExpression(s.expression)}else bt(e,t.position);else o=r.value===null?!0:r.value;n[i]=o}return n}function Cn(e,t){const n=[];let r=-1;const i=e.passKeys?new Map:Go;for(;++r<t.children.length;){const o=t.children[r];let a;if(e.passKeys){const l=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(l){const u=i.get(l)||0;a=l+"-"+u,i.set(l,u+1)}}const s=Xr(e,o,a);s!==void 0&&n.push(s)}return n}function ua(e,t,n){const r=fo(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?no(n):bo(n)),r.property==="style"){let i=typeof n=="object"?n:da(e,String(n));return e.stylePropertyNameCase==="css"&&(i=pa(i)),["style",i]}return[e.elementAttributeNameCase==="react"&&r.space?po[r.property]||r.property:r.attribute,n]}}function da(e,t){try{return Wo(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,i=new Ne("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=Jr+"#cannot-parse-style-attribute",i}}function Zr(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const i=t.split(".");let o=-1,a;for(;++o<i.length;){const s=Yn(i[o])?{type:"Identifier",name:i[o]}:{type:"Literal",value:i[o]};a=a?{type:"MemberExpression",object:a,property:s,computed:!!(o&&s.type==="Literal"),optional:!1}:s}r=a}else r=Yn(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const i=r.value;return kn.call(e.components,i)?e.components[i]:i}if(e.evaluater)return e.evaluater.evaluateExpression(r);bt(e)}function bt(e,t){const n=new Ne("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=Jr+"#cannot-handle-mdx-estrees-without-createevaluater",n}function pa(e){const t={};let n;for(n in e)kn.call(e,n)&&(t[ha(n)]=e[n]);return t}function ha(e){let t=e.replace(Jo,ma);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function ma(e){return"-"+e.toLowerCase()}const qt={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},fa={};function ga(e,t){const n=fa,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return ei(e,r,i)}function ei(e,t,n){if(ya(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return nr(e.children,t,n)}return Array.isArray(e)?nr(e,t,n):""}function nr(e,t,n){const r=[];let i=-1;for(;++i<e.length;)r[i]=ei(e[i],t,n);return r.join("")}function ya(e){return!!(e&&typeof e=="object")}const rr=document.createElement("i");function In(e){const t="&"+e+";";rr.innerHTML=t;const n=rr.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Ye(e,t,n,r){const i=e.length;let o=0,a;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,n=n>0?n:0,r.length<1e4)a=Array.from(r),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);o<r.length;)a=r.slice(o,o+1e4),a.unshift(t,0),e.splice(...a),o+=1e4,t+=1e4}function Fe(e,t){return e.length>0?(Ye(e,e.length,0,t),e):t}const ir={}.hasOwnProperty;function xa(e){const t={};let n=-1;for(;++n<e.length;)ba(t,e[n]);return t}function ba(e,t){let n;for(n in t){const i=(ir.call(e,n)?e[n]:void 0)||(e[n]={}),o=t[n];let a;if(o)for(a in o){ir.call(i,a)||(i[a]=[]);const s=o[a];wa(i[a],Array.isArray(s)?s:s?[s]:[])}}}function wa(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);Ye(e,0,0,r)}function ti(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"ï¿½":String.fromCodePoint(n)}function lt(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const He=Xe(/[A-Za-z]/),je=Xe(/[\dA-Za-z]/),Sa=Xe(/[#-'*+\--9=?A-Z^-~]/);function dn(e){return e!==null&&(e<32||e===127)}const pn=Xe(/\d/),ka=Xe(/[\dA-Fa-f]/),va=Xe(/[!-/:-@[-`{-~]/);function V(e){return e!==null&&e<-2}function Le(e){return e!==null&&(e<0||e===32)}function ae(e){return e===-2||e===-1||e===32}const Ca=Xe(new RegExp("\\p{P}|\\p{S}","u")),Ia=Xe(/\s/);function Xe(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function ut(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const o=e.charCodeAt(n);let a="";if(o===37&&je(e.charCodeAt(n+1))&&je(e.charCodeAt(n+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(a=String.fromCharCode(o));else if(o>55295&&o<57344){const s=e.charCodeAt(n+1);o<56320&&s>56319&&s<57344?(a=String.fromCharCode(o,s),i=1):a="ï¿½"}else a=String.fromCharCode(o);a&&(t.push(e.slice(r,n),encodeURIComponent(a)),r=n+i+1,a=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function he(e,t,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let o=0;return a;function a(l){return ae(l)?(e.enter(n),s(l)):t(l)}function s(l){return ae(l)&&o++<i?(e.consume(l),s):(e.exit(n),t(l))}}const Na={tokenize:Ea};function Ea(e){const t=e.attempt(this.parser.constructs.contentInitial,r,i);let n;return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),he(e,t,"linePrefix")}function i(s){return e.enter("paragraph"),o(s)}function o(s){const l=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,a(s)}function a(s){if(s===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(s);return}return V(s)?(e.consume(s),e.exit("chunkText"),o):(e.consume(s),a)}}const Pa={tokenize:Aa},or={tokenize:Ta};function Aa(e){const t=this,n=[];let r=0,i,o,a;return s;function s(R){if(r<n.length){const ne=n[r];return t.containerState=ne[1],e.attempt(ne[0].continuation,l,u)(R)}return u(R)}function l(R){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&U();const ne=t.events.length;let se=ne,N;for(;se--;)if(t.events[se][0]==="exit"&&t.events[se][1].type==="chunkFlow"){N=t.events[se][1].end;break}P(r);let y=ne;for(;y<t.events.length;)t.events[y][1].end={...N},y++;return Ye(t.events,se+1,0,t.events.slice(ne)),t.events.length=y,u(R)}return s(R)}function u(R){if(r===n.length){if(!i)return f(R);if(i.currentConstruct&&i.currentConstruct.concrete)return S(R);t.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(or,c,p)(R)}function c(R){return i&&U(),P(r),f(R)}function p(R){return t.parser.lazy[t.now().line]=r!==n.length,a=t.now().offset,S(R)}function f(R){return t.containerState={},e.attempt(or,d,S)(R)}function d(R){return r++,n.push([t.currentConstruct,t.containerState]),f(R)}function S(R){if(R===null){i&&U(),P(0),e.consume(R);return}return i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:o}),I(R)}function I(R){if(R===null){F(e.exit("chunkFlow"),!0),P(0),e.consume(R);return}return V(R)?(e.consume(R),F(e.exit("chunkFlow")),r=0,t.interrupt=void 0,s):(e.consume(R),I)}function F(R,ne){const se=t.sliceStream(R);if(ne&&se.push(null),R.previous=o,o&&(o.next=R),o=R,i.defineSkip(R.start),i.write(se),t.parser.lazy[R.start.line]){let N=i.events.length;for(;N--;)if(i.events[N][1].start.offset<a&&(!i.events[N][1].end||i.events[N][1].end.offset>a))return;const y=t.events.length;let b=y,_,C;for(;b--;)if(t.events[b][0]==="exit"&&t.events[b][1].type==="chunkFlow"){if(_){C=t.events[b][1].end;break}_=!0}for(P(r),N=y;N<t.events.length;)t.events[N][1].end={...C},N++;Ye(t.events,b+1,0,t.events.slice(y)),t.events.length=N}}function P(R){let ne=n.length;for(;ne-- >R;){const se=n[ne];t.containerState=se[1],se[0].exit.call(t,e)}n.length=R}function U(){i.write([null]),o=void 0,i=void 0,t.containerState._closeFlow=void 0}}function Ta(e,t,n){return he(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function ar(e){if(e===null||Le(e)||Ia(e))return 1;if(Ca(e))return 2}function Nn(e,t,n){const r=[];let i=-1;for(;++i<e.length;){const o=e[i].resolveAll;o&&!r.includes(o)&&(t=o(t,n),r.push(o))}return t}const hn={name:"attention",resolveAll:_a,tokenize:La};function _a(e,t){let n=-1,r,i,o,a,s,l,u,c;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;l=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const p={...e[r][1].end},f={...e[n][1].start};sr(p,-l),sr(f,l),a={type:l>1?"strongSequence":"emphasisSequence",start:p,end:{...e[r][1].end}},s={type:l>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:f},o={type:l>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},i={type:l>1?"strong":"emphasis",start:{...a.start},end:{...s.end}},e[r][1].end={...a.start},e[n][1].start={...s.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Fe(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Fe(u,[["enter",i,t],["enter",a,t],["exit",a,t],["enter",o,t]]),u=Fe(u,Nn(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=Fe(u,[["exit",o,t],["enter",s,t],["exit",s,t],["exit",i,t]]),e[n][1].end.offset-e[n][1].start.offset?(c=2,u=Fe(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):c=0,Ye(e,r-1,n-r+3,u),n=r+u.length-c-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function La(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=ar(r);let o;return a;function a(l){return o=l,e.enter("attentionSequence"),s(l)}function s(l){if(l===o)return e.consume(l),s;const u=e.exit("attentionSequence"),c=ar(l),p=!c||c===2&&i||n.includes(l),f=!i||i===2&&c||n.includes(r);return u._open=!!(o===42?p:p&&(i||!f)),u._close=!!(o===42?f:f&&(c||!p)),t(l)}}function sr(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Ma={name:"autolink",tokenize:Oa};function Oa(e,t,n){let r=0;return i;function i(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(d){return He(d)?(e.consume(d),a):d===64?n(d):u(d)}function a(d){return d===43||d===45||d===46||je(d)?(r=1,s(d)):u(d)}function s(d){return d===58?(e.consume(d),r=0,l):(d===43||d===45||d===46||je(d))&&r++<32?(e.consume(d),s):(r=0,u(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||dn(d)?n(d):(e.consume(d),l)}function u(d){return d===64?(e.consume(d),c):Sa(d)?(e.consume(d),u):n(d)}function c(d){return je(d)?p(d):n(d)}function p(d){return d===46?(e.consume(d),r=0,c):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):f(d)}function f(d){if((d===45||je(d))&&r++<63){const S=d===45?f:p;return e.consume(d),S}return n(d)}}const jt={partial:!0,tokenize:Da};function Da(e,t,n){return r;function r(o){return ae(o)?he(e,i,"linePrefix")(o):i(o)}function i(o){return o===null||V(o)?t(o):n(o)}}const ni={continuation:{tokenize:$a},exit:Ra,name:"blockQuote",tokenize:ja};function ja(e,t,n){const r=this;return i;function i(a){if(a===62){const s=r.containerState;return s.open||(e.enter("blockQuote",{_container:!0}),s.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),o}return n(a)}function o(a){return ae(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function $a(e,t,n){const r=this;return i;function i(a){return ae(a)?he(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):o(a)}function o(a){return e.attempt(ni,t,n)(a)}}function Ra(e){e.exit("blockQuote")}const ri={name:"characterEscape",tokenize:Fa};function Fa(e,t,n){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),i}function i(o){return va(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(o)}}const ii={name:"characterReference",tokenize:za};function za(e,t,n){const r=this;let i=0,o,a;return s;function s(p){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),l}function l(p){return p===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(p),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,a=je,c(p))}function u(p){return p===88||p===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(p),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,a=ka,c):(e.enter("characterReferenceValue"),o=7,a=pn,c(p))}function c(p){if(p===59&&i){const f=e.exit("characterReferenceValue");return a===je&&!In(r.sliceSerialize(f))?n(p):(e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(p)&&i++<o?(e.consume(p),c):n(p)}}const lr={partial:!0,tokenize:Ua},cr={concrete:!0,name:"codeFenced",tokenize:Ba};function Ba(e,t,n){const r=this,i={partial:!0,tokenize:se};let o=0,a=0,s;return l;function l(N){return u(N)}function u(N){const y=r.events[r.events.length-1];return o=y&&y[1].type==="linePrefix"?y[2].sliceSerialize(y[1],!0).length:0,s=N,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),c(N)}function c(N){return N===s?(a++,e.consume(N),c):a<3?n(N):(e.exit("codeFencedFenceSequence"),ae(N)?he(e,p,"whitespace")(N):p(N))}function p(N){return N===null||V(N)?(e.exit("codeFencedFence"),r.interrupt?t(N):e.check(lr,I,ne)(N)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(N))}function f(N){return N===null||V(N)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),p(N)):ae(N)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),he(e,d,"whitespace")(N)):N===96&&N===s?n(N):(e.consume(N),f)}function d(N){return N===null||V(N)?p(N):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(N))}function S(N){return N===null||V(N)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(N)):N===96&&N===s?n(N):(e.consume(N),S)}function I(N){return e.attempt(i,ne,F)(N)}function F(N){return e.enter("lineEnding"),e.consume(N),e.exit("lineEnding"),P}function P(N){return o>0&&ae(N)?he(e,U,"linePrefix",o+1)(N):U(N)}function U(N){return N===null||V(N)?e.check(lr,I,ne)(N):(e.enter("codeFlowValue"),R(N))}function R(N){return N===null||V(N)?(e.exit("codeFlowValue"),U(N)):(e.consume(N),R)}function ne(N){return e.exit("codeFenced"),t(N)}function se(N,y,b){let _=0;return C;function C(T){return N.enter("lineEnding"),N.consume(T),N.exit("lineEnding"),v}function v(T){return N.enter("codeFencedFence"),ae(T)?he(N,k,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(T):k(T)}function k(T){return T===s?(N.enter("codeFencedFenceSequence"),w(T)):b(T)}function w(T){return T===s?(_++,N.consume(T),w):_>=a?(N.exit("codeFencedFenceSequence"),ae(T)?he(N,O,"whitespace")(T):O(T)):b(T)}function O(T){return T===null||V(T)?(N.exit("codeFencedFence"),y(T)):b(T)}}}function Ua(e,t,n){const r=this;return i;function i(a){return a===null?n(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),o)}function o(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}const Wt={name:"codeIndented",tokenize:Ha},Va={partial:!0,tokenize:Ya};function Ha(e,t,n){const r=this;return i;function i(u){return e.enter("codeIndented"),he(e,o,"linePrefix",5)(u)}function o(u){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?a(u):n(u)}function a(u){return u===null?l(u):V(u)?e.attempt(Va,a,l)(u):(e.enter("codeFlowValue"),s(u))}function s(u){return u===null||V(u)?(e.exit("codeFlowValue"),a(u)):(e.consume(u),s)}function l(u){return e.exit("codeIndented"),t(u)}}function Ya(e,t,n){const r=this;return i;function i(a){return r.parser.lazy[r.now().line]?n(a):V(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):he(e,o,"linePrefix",5)(a)}function o(a){const s=r.events[r.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):V(a)?i(a):n(a)}}const qa={name:"codeText",previous:Ka,resolve:Wa,tokenize:Ga};function Wa(e){let t=e.length-4,n=3,r,i;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)i===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(i=r):(r===t||e[r][1].type==="lineEnding")&&(e[i][1].type="codeTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return e}function Ka(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Ga(e,t,n){let r=0,i,o;return a;function a(p){return e.enter("codeText"),e.enter("codeTextSequence"),s(p)}function s(p){return p===96?(e.consume(p),r++,s):(e.exit("codeTextSequence"),l(p))}function l(p){return p===null?n(p):p===32?(e.enter("space"),e.consume(p),e.exit("space"),l):p===96?(o=e.enter("codeTextSequence"),i=0,c(p)):V(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),l):(e.enter("codeTextData"),u(p))}function u(p){return p===null||p===32||p===96||V(p)?(e.exit("codeTextData"),l(p)):(e.consume(p),u)}function c(p){return p===96?(e.consume(p),i++,c):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(p)):(o.type="codeTextData",u(p))}}class Ja{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const i=n||0;this.setCursor(Math.trunc(t));const o=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&mt(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),mt(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),mt(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);mt(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);mt(this.left,n.reverse())}}}function mt(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function oi(e){const t={};let n=-1,r,i,o,a,s,l,u;const c=new Ja(e);for(;++n<c.length;){for(;n in t;)n=t[n];if(r=c.get(n),n&&r[1].type==="chunkFlow"&&c.get(n-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,o=0,o<l.length&&l[o][1].type==="lineEndingBlank"&&(o+=2),o<l.length&&l[o][1].type==="content"))for(;++o<l.length&&l[o][1].type!=="content";)l[o][1].type==="chunkText"&&(l[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,Xa(c,n)),n=t[n],u=!0);else if(r[1]._container){for(o=n,i=void 0;o--;)if(a=c.get(o),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(i&&(c.get(i)[1].type="lineEndingBlank"),a[1].type="lineEnding",i=o);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;i&&(r[1].end={...c.get(i)[1].start},s=c.slice(i,n),s.unshift(r),c.splice(i,n-i+1,s))}}return Ye(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!u}function Xa(e,t){const n=e.get(t)[1],r=e.get(t)[2];let i=t-1;const o=[];let a=n._tokenizer;a||(a=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const s=a.events,l=[],u={};let c,p,f=-1,d=n,S=0,I=0;const F=[I];for(;d;){for(;e.get(++i)[1]!==d;);o.push(i),d._tokenizer||(c=r.sliceStream(d),d.next||c.push(null),p&&a.defineSkip(d.start),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),p=d,d=d.next}for(d=n;++f<s.length;)s[f][0]==="exit"&&s[f-1][0]==="enter"&&s[f][1].type===s[f-1][1].type&&s[f][1].start.line!==s[f][1].end.line&&(I=f+1,F.push(I),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(a.events=[],d?(d._tokenizer=void 0,d.previous=void 0):F.pop(),f=F.length;f--;){const P=s.slice(F[f],F[f+1]),U=o.pop();l.push([U,U+P.length-1]),e.splice(U,2,P)}for(l.reverse(),f=-1;++f<l.length;)u[S+l[f][0]]=S+l[f][1],S+=l[f][1]-l[f][0]-1;return u}const Qa={resolve:es,tokenize:ts},Za={partial:!0,tokenize:ns};function es(e){return oi(e),e}function ts(e,t){let n;return r;function r(s){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(s)}function i(s){return s===null?o(s):V(s)?e.check(Za,a,o)(s):(e.consume(s),i)}function o(s){return e.exit("chunkContent"),e.exit("content"),t(s)}function a(s){return e.consume(s),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function ns(e,t,n){const r=this;return i;function i(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),he(e,o,"linePrefix")}function o(a){if(a===null||V(a))return n(a);const s=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):e.interrupt(r.parser.constructs.flow,n,t)(a)}}function ai(e,t,n,r,i,o,a,s,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return p;function p(P){return P===60?(e.enter(r),e.enter(i),e.enter(o),e.consume(P),e.exit(o),f):P===null||P===32||P===41||dn(P)?n(P):(e.enter(r),e.enter(a),e.enter(s),e.enter("chunkString",{contentType:"string"}),I(P))}function f(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(i),e.exit(r),t):(e.enter(s),e.enter("chunkString",{contentType:"string"}),d(P))}function d(P){return P===62?(e.exit("chunkString"),e.exit(s),f(P)):P===null||P===60||V(P)?n(P):(e.consume(P),P===92?S:d)}function S(P){return P===60||P===62||P===92?(e.consume(P),d):d(P)}function I(P){return!c&&(P===null||P===41||Le(P))?(e.exit("chunkString"),e.exit(s),e.exit(a),e.exit(r),t(P)):c<u&&P===40?(e.consume(P),c++,I):P===41?(e.consume(P),c--,I):P===null||P===32||P===40||dn(P)?n(P):(e.consume(P),P===92?F:I)}function F(P){return P===40||P===41||P===92?(e.consume(P),I):I(P)}}function si(e,t,n,r,i,o){const a=this;let s=0,l;return u;function u(d){return e.enter(r),e.enter(i),e.consume(d),e.exit(i),e.enter(o),c}function c(d){return s>999||d===null||d===91||d===93&&!l||d===94&&!s&&"_hiddenFootnoteSupport"in a.parser.constructs?n(d):d===93?(e.exit(o),e.enter(i),e.consume(d),e.exit(i),e.exit(r),t):V(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),p(d))}function p(d){return d===null||d===91||d===93||V(d)||s++>999?(e.exit("chunkString"),c(d)):(e.consume(d),l||(l=!ae(d)),d===92?f:p)}function f(d){return d===91||d===92||d===93?(e.consume(d),s++,p):p(d)}}function li(e,t,n,r,i,o){let a;return s;function s(f){return f===34||f===39||f===40?(e.enter(r),e.enter(i),e.consume(f),e.exit(i),a=f===40?41:f,l):n(f)}function l(f){return f===a?(e.enter(i),e.consume(f),e.exit(i),e.exit(r),t):(e.enter(o),u(f))}function u(f){return f===a?(e.exit(o),l(a)):f===null?n(f):V(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),he(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(f))}function c(f){return f===a||f===null||V(f)?(e.exit("chunkString"),u(f)):(e.consume(f),f===92?p:c)}function p(f){return f===a||f===92?(e.consume(f),c):c(f)}}function yt(e,t){let n;return r;function r(i){return V(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),n=!0,r):ae(i)?he(e,r,n?"linePrefix":"lineSuffix")(i):t(i)}}const rs={name:"definition",tokenize:os},is={partial:!0,tokenize:as};function os(e,t,n){const r=this;let i;return o;function o(d){return e.enter("definition"),a(d)}function a(d){return si.call(r,e,s,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function s(d){return i=lt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):n(d)}function l(d){return Le(d)?yt(e,u)(d):u(d)}function u(d){return ai(e,c,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function c(d){return e.attempt(is,p,p)(d)}function p(d){return ae(d)?he(e,f,"whitespace")(d):f(d)}function f(d){return d===null||V(d)?(e.exit("definition"),r.parser.defined.push(i),t(d)):n(d)}}function as(e,t,n){return r;function r(s){return Le(s)?yt(e,i)(s):n(s)}function i(s){return li(e,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function o(s){return ae(s)?he(e,a,"whitespace")(s):a(s)}function a(s){return s===null||V(s)?t(s):n(s)}}const ss={name:"hardBreakEscape",tokenize:ls};function ls(e,t,n){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),i}function i(o){return V(o)?(e.exit("hardBreakEscape"),t(o)):n(o)}}const cs={name:"headingAtx",resolve:us,tokenize:ds};function us(e,t){let n=e.length-2,r=3,i,o;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},o={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},Ye(e,r,n-r+1,[["enter",i,t],["enter",o,t],["exit",o,t],["exit",i,t]])),e}function ds(e,t,n){let r=0;return i;function i(c){return e.enter("atxHeading"),o(c)}function o(c){return e.enter("atxHeadingSequence"),a(c)}function a(c){return c===35&&r++<6?(e.consume(c),a):c===null||Le(c)?(e.exit("atxHeadingSequence"),s(c)):n(c)}function s(c){return c===35?(e.enter("atxHeadingSequence"),l(c)):c===null||V(c)?(e.exit("atxHeading"),t(c)):ae(c)?he(e,s,"whitespace")(c):(e.enter("atxHeadingText"),u(c))}function l(c){return c===35?(e.consume(c),l):(e.exit("atxHeadingSequence"),s(c))}function u(c){return c===null||c===35||Le(c)?(e.exit("atxHeadingText"),s(c)):(e.consume(c),u)}}const ps=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ur=["pre","script","style","textarea"],hs={concrete:!0,name:"htmlFlow",resolveTo:gs,tokenize:ys},ms={partial:!0,tokenize:bs},fs={partial:!0,tokenize:xs};function gs(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function ys(e,t,n){const r=this;let i,o,a,s,l;return u;function u(m){return c(m)}function c(m){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(m),p}function p(m){return m===33?(e.consume(m),f):m===47?(e.consume(m),o=!0,I):m===63?(e.consume(m),i=3,r.interrupt?t:h):He(m)?(e.consume(m),a=String.fromCharCode(m),F):n(m)}function f(m){return m===45?(e.consume(m),i=2,d):m===91?(e.consume(m),i=5,s=0,S):He(m)?(e.consume(m),i=4,r.interrupt?t:h):n(m)}function d(m){return m===45?(e.consume(m),r.interrupt?t:h):n(m)}function S(m){const fe="CDATA[";return m===fe.charCodeAt(s++)?(e.consume(m),s===fe.length?r.interrupt?t:k:S):n(m)}function I(m){return He(m)?(e.consume(m),a=String.fromCharCode(m),F):n(m)}function F(m){if(m===null||m===47||m===62||Le(m)){const fe=m===47,be=a.toLowerCase();return!fe&&!o&&ur.includes(be)?(i=1,r.interrupt?t(m):k(m)):ps.includes(a.toLowerCase())?(i=6,fe?(e.consume(m),P):r.interrupt?t(m):k(m)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(m):o?U(m):R(m))}return m===45||je(m)?(e.consume(m),a+=String.fromCharCode(m),F):n(m)}function P(m){return m===62?(e.consume(m),r.interrupt?t:k):n(m)}function U(m){return ae(m)?(e.consume(m),U):C(m)}function R(m){return m===47?(e.consume(m),C):m===58||m===95||He(m)?(e.consume(m),ne):ae(m)?(e.consume(m),R):C(m)}function ne(m){return m===45||m===46||m===58||m===95||je(m)?(e.consume(m),ne):se(m)}function se(m){return m===61?(e.consume(m),N):ae(m)?(e.consume(m),se):R(m)}function N(m){return m===null||m===60||m===61||m===62||m===96?n(m):m===34||m===39?(e.consume(m),l=m,y):ae(m)?(e.consume(m),N):b(m)}function y(m){return m===l?(e.consume(m),l=null,_):m===null||V(m)?n(m):(e.consume(m),y)}function b(m){return m===null||m===34||m===39||m===47||m===60||m===61||m===62||m===96||Le(m)?se(m):(e.consume(m),b)}function _(m){return m===47||m===62||ae(m)?R(m):n(m)}function C(m){return m===62?(e.consume(m),v):n(m)}function v(m){return m===null||V(m)?k(m):ae(m)?(e.consume(m),v):n(m)}function k(m){return m===45&&i===2?(e.consume(m),D):m===60&&i===1?(e.consume(m),B):m===62&&i===4?(e.consume(m),me):m===63&&i===3?(e.consume(m),h):m===93&&i===5?(e.consume(m),K):V(m)&&(i===6||i===7)?(e.exit("htmlFlowData"),e.check(ms,G,w)(m)):m===null||V(m)?(e.exit("htmlFlowData"),w(m)):(e.consume(m),k)}function w(m){return e.check(fs,O,G)(m)}function O(m){return e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),T}function T(m){return m===null||V(m)?w(m):(e.enter("htmlFlowData"),k(m))}function D(m){return m===45?(e.consume(m),h):k(m)}function B(m){return m===47?(e.consume(m),a="",z):k(m)}function z(m){if(m===62){const fe=a.toLowerCase();return ur.includes(fe)?(e.consume(m),me):k(m)}return He(m)&&a.length<8?(e.consume(m),a+=String.fromCharCode(m),z):k(m)}function K(m){return m===93?(e.consume(m),h):k(m)}function h(m){return m===62?(e.consume(m),me):m===45&&i===2?(e.consume(m),h):k(m)}function me(m){return m===null||V(m)?(e.exit("htmlFlowData"),G(m)):(e.consume(m),me)}function G(m){return e.exit("htmlFlow"),t(m)}}function xs(e,t,n){const r=this;return i;function i(a){return V(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),o):n(a)}function o(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}function bs(e,t,n){return r;function r(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(jt,t,n)}}const ws={name:"htmlText",tokenize:Ss};function Ss(e,t,n){const r=this;let i,o,a;return s;function s(h){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(h),l}function l(h){return h===33?(e.consume(h),u):h===47?(e.consume(h),se):h===63?(e.consume(h),R):He(h)?(e.consume(h),b):n(h)}function u(h){return h===45?(e.consume(h),c):h===91?(e.consume(h),o=0,S):He(h)?(e.consume(h),U):n(h)}function c(h){return h===45?(e.consume(h),d):n(h)}function p(h){return h===null?n(h):h===45?(e.consume(h),f):V(h)?(a=p,B(h)):(e.consume(h),p)}function f(h){return h===45?(e.consume(h),d):p(h)}function d(h){return h===62?D(h):h===45?f(h):p(h)}function S(h){const me="CDATA[";return h===me.charCodeAt(o++)?(e.consume(h),o===me.length?I:S):n(h)}function I(h){return h===null?n(h):h===93?(e.consume(h),F):V(h)?(a=I,B(h)):(e.consume(h),I)}function F(h){return h===93?(e.consume(h),P):I(h)}function P(h){return h===62?D(h):h===93?(e.consume(h),P):I(h)}function U(h){return h===null||h===62?D(h):V(h)?(a=U,B(h)):(e.consume(h),U)}function R(h){return h===null?n(h):h===63?(e.consume(h),ne):V(h)?(a=R,B(h)):(e.consume(h),R)}function ne(h){return h===62?D(h):R(h)}function se(h){return He(h)?(e.consume(h),N):n(h)}function N(h){return h===45||je(h)?(e.consume(h),N):y(h)}function y(h){return V(h)?(a=y,B(h)):ae(h)?(e.consume(h),y):D(h)}function b(h){return h===45||je(h)?(e.consume(h),b):h===47||h===62||Le(h)?_(h):n(h)}function _(h){return h===47?(e.consume(h),D):h===58||h===95||He(h)?(e.consume(h),C):V(h)?(a=_,B(h)):ae(h)?(e.consume(h),_):D(h)}function C(h){return h===45||h===46||h===58||h===95||je(h)?(e.consume(h),C):v(h)}function v(h){return h===61?(e.consume(h),k):V(h)?(a=v,B(h)):ae(h)?(e.consume(h),v):_(h)}function k(h){return h===null||h===60||h===61||h===62||h===96?n(h):h===34||h===39?(e.consume(h),i=h,w):V(h)?(a=k,B(h)):ae(h)?(e.consume(h),k):(e.consume(h),O)}function w(h){return h===i?(e.consume(h),i=void 0,T):h===null?n(h):V(h)?(a=w,B(h)):(e.consume(h),w)}function O(h){return h===null||h===34||h===39||h===60||h===61||h===96?n(h):h===47||h===62||Le(h)?_(h):(e.consume(h),O)}function T(h){return h===47||h===62||Le(h)?_(h):n(h)}function D(h){return h===62?(e.consume(h),e.exit("htmlTextData"),e.exit("htmlText"),t):n(h)}function B(h){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),z}function z(h){return ae(h)?he(e,K,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(h):K(h)}function K(h){return e.enter("htmlTextData"),a(h)}}const En={name:"labelEnd",resolveAll:Is,resolveTo:Ns,tokenize:Es},ks={tokenize:Ps},vs={tokenize:As},Cs={tokenize:Ts};function Is(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",t+=i}}return e.length!==n.length&&Ye(e,0,e.length,n),e}function Ns(e,t){let n=e.length,r=0,i,o,a,s;for(;n--;)if(i=e[n][1],o){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;e[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(a){if(e[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(o=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(a=n);const l={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[a][1].end}},c={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[a-2][1].start}};return s=[["enter",l,t],["enter",u,t]],s=Fe(s,e.slice(o+1,o+r+3)),s=Fe(s,[["enter",c,t]]),s=Fe(s,Nn(t.parser.constructs.insideSpan.null,e.slice(o+r+4,a-3),t)),s=Fe(s,[["exit",c,t],e[a-2],e[a-1],["exit",u,t]]),s=Fe(s,e.slice(a+1)),s=Fe(s,[["exit",l,t]]),Ye(e,o,e.length,s),e}function Es(e,t,n){const r=this;let i=r.events.length,o,a;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){o=r.events[i][1];break}return s;function s(f){return o?o._inactive?p(f):(a=r.parser.defined.includes(lt(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),l):n(f)}function l(f){return f===40?e.attempt(ks,c,a?c:p)(f):f===91?e.attempt(vs,c,a?u:p)(f):a?c(f):p(f)}function u(f){return e.attempt(Cs,c,p)(f)}function c(f){return t(f)}function p(f){return o._balanced=!0,n(f)}}function Ps(e,t,n){return r;function r(p){return e.enter("resource"),e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),i}function i(p){return Le(p)?yt(e,o)(p):o(p)}function o(p){return p===41?c(p):ai(e,a,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function a(p){return Le(p)?yt(e,l)(p):c(p)}function s(p){return n(p)}function l(p){return p===34||p===39||p===40?li(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):c(p)}function u(p){return Le(p)?yt(e,c)(p):c(p)}function c(p){return p===41?(e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),e.exit("resource"),t):n(p)}}function As(e,t,n){const r=this;return i;function i(s){return si.call(r,e,o,a,"reference","referenceMarker","referenceString")(s)}function o(s){return r.parser.defined.includes(lt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(s):n(s)}function a(s){return n(s)}}function Ts(e,t,n){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),i}function i(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),t):n(o)}}const _s={name:"labelStartImage",resolveAll:En.resolveAll,tokenize:Ls};function Ls(e,t,n){const r=this;return i;function i(s){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(s),e.exit("labelImageMarker"),o}function o(s){return s===91?(e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelImage"),a):n(s)}function a(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(s):t(s)}}const Ms={name:"labelStartLink",resolveAll:En.resolveAll,tokenize:Os};function Os(e,t,n){const r=this;return i;function i(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),o}function o(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):t(a)}}const Kt={name:"lineEnding",tokenize:Ds};function Ds(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),he(e,t,"linePrefix")}}const Tt={name:"thematicBreak",tokenize:js};function js(e,t,n){let r=0,i;return o;function o(u){return e.enter("thematicBreak"),a(u)}function a(u){return i=u,s(u)}function s(u){return u===i?(e.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||V(u))?(e.exit("thematicBreak"),t(u)):n(u)}function l(u){return u===i?(e.consume(u),r++,l):(e.exit("thematicBreakSequence"),ae(u)?he(e,s,"whitespace")(u):s(u))}}const _e={continuation:{tokenize:zs},exit:Us,name:"list",tokenize:Fs},$s={partial:!0,tokenize:Vs},Rs={partial:!0,tokenize:Bs};function Fs(e,t,n){const r=this,i=r.events[r.events.length-1];let o=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,a=0;return s;function s(d){const S=r.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||d===r.containerState.marker:pn(d)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(Tt,n,u)(d):u(d);if(!r.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return n(d)}function l(d){return pn(d)&&++a<10?(e.consume(d),l):(!r.interrupt||a<2)&&(r.containerState.marker?d===r.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),u(d)):n(d)}function u(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||d,e.check(jt,r.interrupt?n:c,e.attempt($s,f,p))}function c(d){return r.containerState.initialBlankLine=!0,o++,f(d)}function p(d){return ae(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),f):n(d)}function f(d){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function zs(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(jt,i,o);function i(s){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,he(e,t,"listItemIndent",r.containerState.size+1)(s)}function o(s){return r.containerState.furtherBlankLines||!ae(s)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(s)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(Rs,t,a)(s))}function a(s){return r.containerState._closeFlow=!0,r.interrupt=void 0,he(e,e.attempt(_e,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function Bs(e,t,n){const r=this;return he(e,i,"listItemIndent",r.containerState.size+1);function i(o){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?t(o):n(o)}}function Us(e){e.exit(this.containerState.type)}function Vs(e,t,n){const r=this;return he(e,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(o){const a=r.events[r.events.length-1];return!ae(o)&&a&&a[1].type==="listItemPrefixWhitespace"?t(o):n(o)}}const dr={name:"setextUnderline",resolveTo:Hs,tokenize:Ys};function Hs(e,t){let n=e.length,r,i,o;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(i=n)}else e[n][1].type==="content"&&e.splice(n,1),!o&&e[n][1].type==="definition"&&(o=n);const a={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[i][1].type="setextHeadingText",o?(e.splice(i,0,["enter",a,t]),e.splice(o+1,0,["exit",e[r][1],t]),e[r][1].end={...e[o][1].end}):e[r][1]=a,e.push(["exit",a,t]),e}function Ys(e,t,n){const r=this;let i;return o;function o(u){let c=r.events.length,p;for(;c--;)if(r.events[c][1].type!=="lineEnding"&&r.events[c][1].type!=="linePrefix"&&r.events[c][1].type!=="content"){p=r.events[c][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(e.enter("setextHeadingLine"),i=u,a(u)):n(u)}function a(u){return e.enter("setextHeadingLineSequence"),s(u)}function s(u){return u===i?(e.consume(u),s):(e.exit("setextHeadingLineSequence"),ae(u)?he(e,l,"lineSuffix")(u):l(u))}function l(u){return u===null||V(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const qs={tokenize:Ws};function Ws(e){const t=this,n=e.attempt(jt,r,e.attempt(this.parser.constructs.flowInitial,i,he(e,e.attempt(this.parser.constructs.flow,i,e.attempt(Qa,i)),"linePrefix")));return n;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function i(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const Ks={resolveAll:ui()},Gs=ci("string"),Js=ci("text");function ci(e){return{resolveAll:ui(e==="text"?Xs:void 0),tokenize:t};function t(n){const r=this,i=this.parser.constructs[e],o=n.attempt(i,a,s);return a;function a(c){return u(c)?o(c):s(c)}function s(c){if(c===null){n.consume(c);return}return n.enter("data"),n.consume(c),l}function l(c){return u(c)?(n.exit("data"),o(c)):(n.consume(c),l)}function u(c){if(c===null)return!0;const p=i[c];let f=-1;if(p)for(;++f<p.length;){const d=p[f];if(!d.previous||d.previous.call(r,r.previous))return!0}return!1}}}function ui(e){return t;function t(n,r){let i=-1,o;for(;++i<=n.length;)o===void 0?n[i]&&n[i][1].type==="data"&&(o=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==o+2&&(n[o][1].end=n[i-1][1].end,n.splice(o+2,i-o-2),i=o+2),o=void 0);return e?e(n,r):n}}function Xs(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],i=t.sliceStream(r);let o=i.length,a=-1,s=0,l;for(;o--;){const u=i[o];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)s++,a--;if(a)break;a=-1}else if(u===-2)l=!0,s++;else if(u!==-1){o++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(s=0),s){const u={type:n===e.length||l||s<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:r.start._bufferIndex+a,_index:r.start._index+o,line:r.end.line,column:r.end.column-s,offset:r.end.offset-s},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const Qs={42:_e,43:_e,45:_e,48:_e,49:_e,50:_e,51:_e,52:_e,53:_e,54:_e,55:_e,56:_e,57:_e,62:ni},Zs={91:rs},el={[-2]:Wt,[-1]:Wt,32:Wt},tl={35:cs,42:Tt,45:[dr,Tt],60:hs,61:dr,95:Tt,96:cr,126:cr},nl={38:ii,92:ri},rl={[-5]:Kt,[-4]:Kt,[-3]:Kt,33:_s,38:ii,42:hn,60:[Ma,ws],91:Ms,92:[ss,ri],93:En,95:hn,96:qa},il={null:[hn,Ks]},ol={null:[42,95]},al={null:[]},sl=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:ol,contentInitial:Zs,disable:al,document:Qs,flow:tl,flowInitial:el,insideSpan:il,string:nl,text:rl},Symbol.toStringTag,{value:"Module"}));function ll(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},o=[];let a=[],s=[];const l={attempt:y(se),check:y(N),consume:U,enter:R,exit:ne,interrupt:y(N,{interrupt:!0})},u={code:null,containerState:{},defineSkip:I,events:[],now:S,parser:e,previous:null,sliceSerialize:f,sliceStream:d,write:p};let c=t.tokenize.call(u,l);return t.resolveAll&&o.push(t),u;function p(v){return a=Fe(a,v),F(),a[a.length-1]!==null?[]:(b(t,0),u.events=Nn(o,u.events,u),u.events)}function f(v,k){return ul(d(v),k)}function d(v){return cl(a,v)}function S(){const{_bufferIndex:v,_index:k,line:w,column:O,offset:T}=r;return{_bufferIndex:v,_index:k,line:w,column:O,offset:T}}function I(v){i[v.line]=v.column,C()}function F(){let v;for(;r._index<a.length;){const k=a[r._index];if(typeof k=="string")for(v=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===v&&r._bufferIndex<k.length;)P(k.charCodeAt(r._bufferIndex));else P(k)}}function P(v){c=c(v)}function U(v){V(v)?(r.line++,r.column=1,r.offset+=v===-3?2:1,C()):v!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=v}function R(v,k){const w=k||{};return w.type=v,w.start=S(),u.events.push(["enter",w,u]),s.push(w),w}function ne(v){const k=s.pop();return k.end=S(),u.events.push(["exit",k,u]),k}function se(v,k){b(v,k.from)}function N(v,k){k.restore()}function y(v,k){return w;function w(O,T,D){let B,z,K,h;return Array.isArray(O)?G(O):"tokenize"in O?G([O]):me(O);function me(ie){return $e;function $e(Pe){const Ae=Pe!==null&&ie[Pe],Ee=Pe!==null&&ie.null,dt=[...Array.isArray(Ae)?Ae:Ae?[Ae]:[],...Array.isArray(Ee)?Ee:Ee?[Ee]:[]];return G(dt)(Pe)}}function G(ie){return B=ie,z=0,ie.length===0?D:m(ie[z])}function m(ie){return $e;function $e(Pe){return h=_(),K=ie,ie.partial||(u.currentConstruct=ie),ie.name&&u.parser.constructs.disable.null.includes(ie.name)?be():ie.tokenize.call(k?Object.assign(Object.create(u),k):u,l,fe,be)(Pe)}}function fe(ie){return v(K,h),T}function be(ie){return h.restore(),++z<B.length?m(B[z]):D}}}function b(v,k){v.resolveAll&&!o.includes(v)&&o.push(v),v.resolve&&Ye(u.events,k,u.events.length-k,v.resolve(u.events.slice(k),u)),v.resolveTo&&(u.events=v.resolveTo(u.events,u))}function _(){const v=S(),k=u.previous,w=u.currentConstruct,O=u.events.length,T=Array.from(s);return{from:O,restore:D};function D(){r=v,u.previous=k,u.currentConstruct=w,u.events.length=O,s=T,C()}}function C(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function cl(e,t){const n=t.start._index,r=t.start._bufferIndex,i=t.end._index,o=t.end._bufferIndex;let a;if(n===i)a=[e[n].slice(r,o)];else{if(a=e.slice(n,i),r>-1){const s=a[0];typeof s=="string"?a[0]=s.slice(r):a.shift()}o>0&&a.push(e[i].slice(0,o))}return a}function ul(e,t){let n=-1;const r=[];let i;for(;++n<e.length;){const o=e[n];let a;if(typeof o=="string")a=o;else switch(o){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&i)continue;a=" ";break}default:a=String.fromCharCode(o)}i=o===-2,r.push(a)}return r.join("")}function dl(e){const r={constructs:xa([sl,...(e||{}).extensions||[]]),content:i(Na),defined:[],document:i(Pa),flow:i(qs),lazy:{},string:i(Gs),text:i(Js)};return r;function i(o){return a;function a(s){return ll(r,o,s)}}}function pl(e){for(;!oi(e););return e}const pr=/[\0\t\n\r]/g;function hl(){let e=1,t="",n=!0,r;return i;function i(o,a,s){const l=[];let u,c,p,f,d;for(o=t+(typeof o=="string"?o.toString():new TextDecoder(a||void 0).decode(o)),p=0,t="",n&&(o.charCodeAt(0)===65279&&p++,n=void 0);p<o.length;){if(pr.lastIndex=p,u=pr.exec(o),f=u&&u.index!==void 0?u.index:o.length,d=o.charCodeAt(f),!u){t=o.slice(p);break}if(d===10&&p===f&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),p<f&&(l.push(o.slice(p,f)),e+=f-p),d){case 0:{l.push(65533),e++;break}case 9:{for(c=Math.ceil(e/4)*4,l.push(-2);e++<c;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:r=!0,e=1}p=f+1}return s&&(r&&l.push(-5),t&&l.push(t),l.push(null)),l}}const ml=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function fl(e){return e.replace(ml,gl)}function gl(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),o=i===120||i===88;return ti(n.slice(o?2:1),o?16:10)}return In(n)||e}const di={}.hasOwnProperty;function yl(e,t,n){return typeof t!="string"&&(n=t,t=void 0),xl(n)(pl(dl(n).document().write(hl()(e,t,!0))))}function xl(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qe),autolinkProtocol:_,autolinkEmail:_,atxHeading:o(kt),blockQuote:o(Ee),characterEscape:_,characterReference:_,codeFenced:o(dt),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:o(dt,a),codeText:o(pt,a),codeTextData:_,data:_,codeFlowValue:_,definition:o(Ft),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:o(Mn),hardBreakEscape:o(nt),hardBreakTrailing:o(nt),htmlFlow:o(vt,a),htmlFlowData:_,htmlText:o(vt,a),htmlTextData:_,image:o(Ct),label:a,link:o(qe),listItem:o(ht),listItemValue:f,listOrdered:o(Re,p),listUnordered:o(Re),paragraph:o(zt),reference:m,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:o(kt),strong:o(Bt),thematicBreak:o(Ut)},exit:{atxHeading:l(),atxHeadingSequence:se,autolink:l(),autolinkEmail:Ae,autolinkProtocol:Pe,blockQuote:l(),characterEscapeValue:C,characterReferenceMarkerHexadecimal:be,characterReferenceMarkerNumeric:be,characterReferenceValue:ie,characterReference:$e,codeFenced:l(F),codeFencedFence:I,codeFencedFenceInfo:d,codeFencedFenceMeta:S,codeFlowValue:C,codeIndented:l(P),codeText:l(T),codeTextData:C,data:C,definition:l(),definitionDestinationString:ne,definitionLabelString:U,definitionTitleString:R,emphasis:l(),hardBreakEscape:l(k),hardBreakTrailing:l(k),htmlFlow:l(w),htmlFlowData:C,htmlText:l(O),htmlTextData:C,image:l(B),label:K,labelText:z,lineEnding:v,link:l(D),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:fe,resourceDestinationString:h,resourceTitleString:me,resource:G,setextHeading:l(b),setextHeadingLineSequence:y,setextHeadingText:N,strong:l(),thematicBreak:l()}};pi(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(x){let L={type:"root",children:[]};const H={stack:[L],tokenStack:[],config:t,enter:s,exit:u,buffer:a,resume:c,data:n},W=[];let le=-1;for(;++le<x.length;)if(x[le][1].type==="listOrdered"||x[le][1].type==="listUnordered")if(x[le][0]==="enter")W.push(le);else{const Oe=W.pop();le=i(x,Oe,le)}for(le=-1;++le<x.length;){const Oe=t[x[le][0]];di.call(Oe,x[le][1].type)&&Oe[x[le][1].type].call(Object.assign({sliceSerialize:x[le][2].sliceSerialize},H),x[le][1])}if(H.tokenStack.length>0){const Oe=H.tokenStack[H.tokenStack.length-1];(Oe[1]||hr).call(H,void 0,Oe[0])}for(L.position={start:Ge(x.length>0?x[0][1].start:{line:1,column:1,offset:0}),end:Ge(x.length>0?x[x.length-2][1].end:{line:1,column:1,offset:0})},le=-1;++le<t.transforms.length;)L=t.transforms[le](L)||L;return L}function i(x,L,H){let W=L-1,le=-1,Oe=!1,Be,Te,Qe,Ze;for(;++W<=H;){const Ce=x[W];switch(Ce[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ce[0]==="enter"?le++:le--,Ze=void 0;break}case"lineEndingBlank":{Ce[0]==="enter"&&(Be&&!Ze&&!le&&!Qe&&(Qe=W),Ze=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ze=void 0}if(!le&&Ce[0]==="enter"&&Ce[1].type==="listItemPrefix"||le===-1&&Ce[0]==="exit"&&(Ce[1].type==="listUnordered"||Ce[1].type==="listOrdered")){if(Be){let M=W;for(Te=void 0;M--;){const j=x[M];if(j[1].type==="lineEnding"||j[1].type==="lineEndingBlank"){if(j[0]==="exit")continue;Te&&(x[Te][1].type="lineEndingBlank",Oe=!0),j[1].type="lineEnding",Te=M}else if(!(j[1].type==="linePrefix"||j[1].type==="blockQuotePrefix"||j[1].type==="blockQuotePrefixWhitespace"||j[1].type==="blockQuoteMarker"||j[1].type==="listItemIndent"))break}Qe&&(!Te||Qe<Te)&&(Be._spread=!0),Be.end=Object.assign({},Te?x[Te][1].start:Ce[1].end),x.splice(Te||W,0,["exit",Be,Ce[2]]),W++,H++}if(Ce[1].type==="listItemPrefix"){const M={type:"listItem",_spread:!1,start:Object.assign({},Ce[1].start),end:void 0};Be=M,x.splice(W,0,["enter",M,Ce[2]]),W++,H++,Qe=void 0,Ze=!0}}}return x[L][1]._spread=Oe,H}function o(x,L){return H;function H(W){s.call(this,x(W),W),L&&L.call(this,W)}}function a(){this.stack.push({type:"fragment",children:[]})}function s(x,L,H){this.stack[this.stack.length-1].children.push(x),this.stack.push(x),this.tokenStack.push([L,H||void 0]),x.position={start:Ge(L.start),end:void 0}}function l(x){return L;function L(H){x&&x.call(this,H),u.call(this,H)}}function u(x,L){const H=this.stack.pop(),W=this.tokenStack.pop();if(W)W[0].type!==x.type&&(L?L.call(this,x,W[0]):(W[1]||hr).call(this,x,W[0]));else throw new Error("Cannot close `"+x.type+"` ("+gt({start:x.start,end:x.end})+"): itâ€™s not open");H.position.end=Ge(x.end)}function c(){return ga(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function f(x){if(this.data.expectingFirstListItemValue){const L=this.stack[this.stack.length-2];L.start=Number.parseInt(this.sliceSerialize(x),10),this.data.expectingFirstListItemValue=void 0}}function d(){const x=this.resume(),L=this.stack[this.stack.length-1];L.lang=x}function S(){const x=this.resume(),L=this.stack[this.stack.length-1];L.meta=x}function I(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function F(){const x=this.resume(),L=this.stack[this.stack.length-1];L.value=x.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const x=this.resume(),L=this.stack[this.stack.length-1];L.value=x.replace(/(\r?\n|\r)$/g,"")}function U(x){const L=this.resume(),H=this.stack[this.stack.length-1];H.label=L,H.identifier=lt(this.sliceSerialize(x)).toLowerCase()}function R(){const x=this.resume(),L=this.stack[this.stack.length-1];L.title=x}function ne(){const x=this.resume(),L=this.stack[this.stack.length-1];L.url=x}function se(x){const L=this.stack[this.stack.length-1];if(!L.depth){const H=this.sliceSerialize(x).length;L.depth=H}}function N(){this.data.setextHeadingSlurpLineEnding=!0}function y(x){const L=this.stack[this.stack.length-1];L.depth=this.sliceSerialize(x).codePointAt(0)===61?1:2}function b(){this.data.setextHeadingSlurpLineEnding=void 0}function _(x){const H=this.stack[this.stack.length-1].children;let W=H[H.length-1];(!W||W.type!=="text")&&(W=rt(),W.position={start:Ge(x.start),end:void 0},H.push(W)),this.stack.push(W)}function C(x){const L=this.stack.pop();L.value+=this.sliceSerialize(x),L.position.end=Ge(x.end)}function v(x){const L=this.stack[this.stack.length-1];if(this.data.atHardBreak){const H=L.children[L.children.length-1];H.position.end=Ge(x.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(L.type)&&(_.call(this,x),C.call(this,x))}function k(){this.data.atHardBreak=!0}function w(){const x=this.resume(),L=this.stack[this.stack.length-1];L.value=x}function O(){const x=this.resume(),L=this.stack[this.stack.length-1];L.value=x}function T(){const x=this.resume(),L=this.stack[this.stack.length-1];L.value=x}function D(){const x=this.stack[this.stack.length-1];if(this.data.inReference){const L=this.data.referenceType||"shortcut";x.type+="Reference",x.referenceType=L,delete x.url,delete x.title}else delete x.identifier,delete x.label;this.data.referenceType=void 0}function B(){const x=this.stack[this.stack.length-1];if(this.data.inReference){const L=this.data.referenceType||"shortcut";x.type+="Reference",x.referenceType=L,delete x.url,delete x.title}else delete x.identifier,delete x.label;this.data.referenceType=void 0}function z(x){const L=this.sliceSerialize(x),H=this.stack[this.stack.length-2];H.label=fl(L),H.identifier=lt(L).toLowerCase()}function K(){const x=this.stack[this.stack.length-1],L=this.resume(),H=this.stack[this.stack.length-1];if(this.data.inReference=!0,H.type==="link"){const W=x.children;H.children=W}else H.alt=L}function h(){const x=this.resume(),L=this.stack[this.stack.length-1];L.url=x}function me(){const x=this.resume(),L=this.stack[this.stack.length-1];L.title=x}function G(){this.data.inReference=void 0}function m(){this.data.referenceType="collapsed"}function fe(x){const L=this.resume(),H=this.stack[this.stack.length-1];H.label=L,H.identifier=lt(this.sliceSerialize(x)).toLowerCase(),this.data.referenceType="full"}function be(x){this.data.characterReferenceType=x.type}function ie(x){const L=this.sliceSerialize(x),H=this.data.characterReferenceType;let W;H?(W=ti(L,H==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):W=In(L);const le=this.stack[this.stack.length-1];le.value+=W}function $e(x){const L=this.stack.pop();L.position.end=Ge(x.end)}function Pe(x){C.call(this,x);const L=this.stack[this.stack.length-1];L.url=this.sliceSerialize(x)}function Ae(x){C.call(this,x);const L=this.stack[this.stack.length-1];L.url="mailto:"+this.sliceSerialize(x)}function Ee(){return{type:"blockquote",children:[]}}function dt(){return{type:"code",lang:null,meta:null,value:""}}function pt(){return{type:"inlineCode",value:""}}function Ft(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Mn(){return{type:"emphasis",children:[]}}function kt(){return{type:"heading",depth:0,children:[]}}function nt(){return{type:"break"}}function vt(){return{type:"html",value:""}}function Ct(){return{type:"image",title:null,url:"",alt:null}}function qe(){return{type:"link",title:null,url:"",children:[]}}function Re(x){return{type:"list",ordered:x.type==="listOrdered",start:null,spread:x._spread,children:[]}}function ht(x){return{type:"listItem",spread:x._spread,checked:null,children:[]}}function zt(){return{type:"paragraph",children:[]}}function Bt(){return{type:"strong",children:[]}}function rt(){return{type:"text",value:""}}function Ut(){return{type:"thematicBreak"}}}function Ge(e){return{line:e.line,column:e.column,offset:e.offset}}function pi(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?pi(e,r):bl(e,r)}}function bl(e,t){let n;for(n in t)if(di.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function hr(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+gt({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+gt({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+gt({start:t.start,end:t.end})+") is still open")}function wl(e){const t=this;t.parser=n;function n(r){return yl(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function Sl(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function kl(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function vl(e,t){const n=t.value?t.value+`
`:"",r={},i=t.lang?t.lang.split(/\s+/):[];i.length>0&&(r.className=["language-"+i[0]]);let o={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(o.data={meta:t.meta}),e.patch(t,o),o=e.applyData(t,o),o={type:"element",tagName:"pre",properties:{},children:[o]},e.patch(t,o),o}function Cl(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Il(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Nl(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=ut(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let a,s=e.footnoteCounts.get(r);s===void 0?(s=0,e.footnoteOrder.push(r),a=e.footnoteOrder.length):a=o+1,s+=1,e.footnoteCounts.set(r,s);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(s>1?"-"+s:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,u),e.applyData(t,u)}function El(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Pl(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function hi(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),o=i[0];o&&o.type==="text"?o.value="["+o.value:i.unshift({type:"text",value:"["});const a=i[i.length-1];return a&&a.type==="text"?a.value+=r:i.push({type:"text",value:r}),i}function Al(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return hi(e,t);const i={src:ut(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const o={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,o),e.applyData(t,o)}function Tl(e,t){const n={src:ut(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function _l(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function Ll(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return hi(e,t);const i={href:ut(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const o={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,o),e.applyData(t,o)}function Ml(e,t){const n={href:ut(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Ol(e,t,n){const r=e.all(t),i=n?Dl(n):mi(t),o={},a=[];if(typeof t.checked=="boolean"){const c=r[0];let p;c&&c.type==="element"&&c.tagName==="p"?p=c:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let s=-1;for(;++s<r.length;){const c=r[s];(i||s!==0||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!i?a.push(...c.children):a.push(c)}const l=r[r.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:a};return e.patch(t,u),e.applyData(t,u)}function Dl(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=mi(n[r])}return t}function mi(e){const t=e.spread;return t??e.children.length>1}function jl(e,t){const n={},r=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++i<r.length;){const a=r[i];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const o={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,o),e.applyData(t,o)}function $l(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Rl(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function Fl(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function zl(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],a),i.push(a)}if(n.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},s=Sn(t.children[1]),l=Kr(t.children[t.children.length-1]);s&&l&&(a.position={start:s,end:l}),i.push(a)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,o),e.applyData(t,o)}function Bl(e,t,n){const r=n?n.children:void 0,o=(r?r.indexOf(t):1)===0?"th":"td",a=n&&n.type==="table"?n.align:void 0,s=a?a.length:t.children.length;let l=-1;const u=[];for(;++l<s;){const p=t.children[l],f={},d=a?a[l]:void 0;d&&(f.align=d);let S={type:"element",tagName:o,properties:f,children:[]};p&&(S.children=e.all(p),e.patch(p,S),S=e.applyData(p,S)),u.push(S)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,c),e.applyData(t,c)}function Ul(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const mr=9,fr=32;function Vl(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const o=[];for(;r;)o.push(gr(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return o.push(gr(t.slice(i),i>0,!1)),o.join("")}function gr(e,t,n){let r=0,i=e.length;if(t){let o=e.codePointAt(r);for(;o===mr||o===fr;)r++,o=e.codePointAt(r)}if(n){let o=e.codePointAt(i-1);for(;o===mr||o===fr;)i--,o=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}function Hl(e,t){const n={type:"text",value:Vl(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function Yl(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const ql={blockquote:Sl,break:kl,code:vl,delete:Cl,emphasis:Il,footnoteReference:Nl,heading:El,html:Pl,imageReference:Al,image:Tl,inlineCode:_l,linkReference:Ll,link:Ml,listItem:Ol,list:jl,paragraph:$l,root:Rl,strong:Fl,table:zl,tableCell:Ul,tableRow:Bl,text:Hl,thematicBreak:Yl,toml:Et,yaml:Et,definition:Et,footnoteDefinition:Et};function Et(){}const fi=-1,$t=0,xt=1,Mt=2,Pn=3,An=4,Tn=5,_n=6,gi=7,yi=8,yr=typeof self=="object"?self:globalThis,Wl=(e,t)=>{const n=(i,o)=>(e.set(o,i),i),r=i=>{if(e.has(i))return e.get(i);const[o,a]=t[i];switch(o){case $t:case fi:return n(a,i);case xt:{const s=n([],i);for(const l of a)s.push(r(l));return s}case Mt:{const s=n({},i);for(const[l,u]of a)s[r(l)]=r(u);return s}case Pn:return n(new Date(a),i);case An:{const{source:s,flags:l}=a;return n(new RegExp(s,l),i)}case Tn:{const s=n(new Map,i);for(const[l,u]of a)s.set(r(l),r(u));return s}case _n:{const s=n(new Set,i);for(const l of a)s.add(r(l));return s}case gi:{const{name:s,message:l}=a;return n(new yr[s](l),i)}case yi:return n(BigInt(a),i);case"BigInt":return n(Object(BigInt(a)),i);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:s}=new Uint8Array(a);return n(new DataView(s),a)}}return n(new yr[o](a),i)};return r},xr=e=>Wl(new Map,e)(0),at="",{toString:Kl}={},{keys:Gl}=Object,ft=e=>{const t=typeof e;if(t!=="object"||!e)return[$t,t];const n=Kl.call(e).slice(8,-1);switch(n){case"Array":return[xt,at];case"Object":return[Mt,at];case"Date":return[Pn,at];case"RegExp":return[An,at];case"Map":return[Tn,at];case"Set":return[_n,at];case"DataView":return[xt,n]}return n.includes("Array")?[xt,n]:n.includes("Error")?[gi,n]:[Mt,n]},Pt=([e,t])=>e===$t&&(t==="function"||t==="symbol"),Jl=(e,t,n,r)=>{const i=(a,s)=>{const l=r.push(a)-1;return n.set(s,l),l},o=a=>{if(n.has(a))return n.get(a);let[s,l]=ft(a);switch(s){case $t:{let c=a;switch(l){case"bigint":s=yi,c=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return i([fi],a)}return i([s,c],a)}case xt:{if(l){let f=a;return l==="DataView"?f=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(f=new Uint8Array(a)),i([l,[...f]],a)}const c=[],p=i([s,c],a);for(const f of a)c.push(o(f));return p}case Mt:{if(l)switch(l){case"BigInt":return i([l,a.toString()],a);case"Boolean":case"Number":case"String":return i([l,a.valueOf()],a)}if(t&&"toJSON"in a)return o(a.toJSON());const c=[],p=i([s,c],a);for(const f of Gl(a))(e||!Pt(ft(a[f])))&&c.push([o(f),o(a[f])]);return p}case Pn:return i([s,a.toISOString()],a);case An:{const{source:c,flags:p}=a;return i([s,{source:c,flags:p}],a)}case Tn:{const c=[],p=i([s,c],a);for(const[f,d]of a)(e||!(Pt(ft(f))||Pt(ft(d))))&&c.push([o(f),o(d)]);return p}case _n:{const c=[],p=i([s,c],a);for(const f of a)(e||!Pt(ft(f)))&&c.push(o(f));return p}}const{message:u}=a;return i([s,{name:l,message:u}],a)};return o},br=(e,{json:t,lossy:n}={})=>{const r=[];return Jl(!(t||n),!!t,new Map,r)(e),r},Ot=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?xr(br(e,t)):structuredClone(e):(e,t)=>xr(br(e,t));function Xl(e,t){const n=[{type:"text",value:"â†©"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function Ql(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function Zl(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||Xl,r=e.options.footnoteBackLabel||Ql,i=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},s=[];let l=-1;for(;++l<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[l]);if(!u)continue;const c=e.all(u),p=String(u.identifier).toUpperCase(),f=ut(p.toLowerCase());let d=0;const S=[],I=e.footnoteCounts.get(p);for(;I!==void 0&&++d<=I;){S.length>0&&S.push({type:"text",value:" "});let U=typeof n=="string"?n:n(l,d);typeof U=="string"&&(U={type:"text",value:U}),S.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,d),className:["data-footnote-backref"]},children:Array.isArray(U)?U:[U]})}const F=c[c.length-1];if(F&&F.type==="element"&&F.tagName==="p"){const U=F.children[F.children.length-1];U&&U.type==="text"?U.value+=" ":F.children.push({type:"text",value:" "}),F.children.push(...S)}else c.push(...S);const P={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(c,!0)};e.patch(u,P),s.push(P)}if(s.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...Ot(a),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(s,!0)},{type:"text",value:`
`}]}}const xi=function(e){if(e==null)return rc;if(typeof e=="function")return Rt(e);if(typeof e=="object")return Array.isArray(e)?ec(e):tc(e);if(typeof e=="string")return nc(e);throw new Error("Expected function, string, or object as test")};function ec(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=xi(e[n]);return Rt(r);function r(...i){let o=-1;for(;++o<t.length;)if(t[o].apply(this,i))return!0;return!1}}function tc(e){const t=e;return Rt(n);function n(r){const i=r;let o;for(o in e)if(i[o]!==t[o])return!1;return!0}}function nc(e){return Rt(t);function t(n){return n&&n.type===e}}function Rt(e){return t;function t(n,r,i){return!!(ic(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function rc(){return!0}function ic(e){return e!==null&&typeof e=="object"&&"type"in e}const bi=[],oc=!0,wr=!1,ac="skip";function sc(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const o=xi(i),a=r?-1:1;s(e,void 0,[])();function s(l,u,c){const p=l&&typeof l=="object"?l:{};if(typeof p.type=="string"){const d=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(l.type+(d?"<"+d+">":""))+")"})}return f;function f(){let d=bi,S,I,F;if((!t||o(l,u,c[c.length-1]||void 0))&&(d=lc(n(l,c)),d[0]===wr))return d;if("children"in l&&l.children){const P=l;if(P.children&&d[0]!==ac)for(I=(r?P.children.length:-1)+a,F=c.concat(P);I>-1&&I<P.children.length;){const U=P.children[I];if(S=s(U,I,F)(),S[0]===wr)return S;I=typeof S[1]=="number"?S[1]:I+a}}return d}}}function lc(e){return Array.isArray(e)?e:typeof e=="number"?[oc,e]:e==null?bi:[e]}function wi(e,t,n,r){let i,o,a;typeof t=="function"&&typeof n!="function"?(o=void 0,a=t,i=n):(o=t,a=n,i=r),sc(e,o,s,i);function s(l,u){const c=u[u.length-1],p=c?c.children.indexOf(l):void 0;return a(l,p,c)}}const mn={}.hasOwnProperty,cc={};function uc(e,t){const n=t||cc,r=new Map,i=new Map,o=new Map,a={...ql,...n.handlers},s={all:u,applyData:pc,definitionById:r,footnoteById:i,footnoteCounts:o,footnoteOrder:[],handlers:a,one:l,options:n,patch:dc,wrap:mc};return wi(e,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const p=c.type==="definition"?r:i,f=String(c.identifier).toUpperCase();p.has(f)||p.set(f,c)}}),s;function l(c,p){const f=c.type,d=s.handlers[f];if(mn.call(s.handlers,f)&&d)return d(s,c,p);if(s.options.passThrough&&s.options.passThrough.includes(f)){if("children"in c){const{children:I,...F}=c,P=Ot(F);return P.children=s.all(c),P}return Ot(c)}return(s.options.unknownHandler||hc)(s,c,p)}function u(c){const p=[];if("children"in c){const f=c.children;let d=-1;for(;++d<f.length;){const S=s.one(f[d],c);if(S){if(d&&f[d-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Sr(S.value)),!Array.isArray(S)&&S.type==="element")){const I=S.children[0];I&&I.type==="text"&&(I.value=Sr(I.value))}Array.isArray(S)?p.push(...S):p.push(S)}}}return p}}function dc(e,t){e.position&&(t.position=Ko(e))}function pc(e,t){let n=t;if(e&&e.data){const r=e.data.hName,i=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const a="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:a}}n.type==="element"&&o&&Object.assign(n.properties,Ot(o)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function hc(e,t){const n=t.data||{},r="value"in t&&!(mn.call(n,"hProperties")||mn.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function mc(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function Sr(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function kr(e,t){const n=uc(e,t),r=n.one(e,void 0),i=Zl(n),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&o.children.push({type:"text",value:`
`},i),o}function fc(e,t){return e&&"run"in e?async function(n,r){const i=kr(n,{file:r,...t});await e.run(i,r)}:function(n,r){return kr(n,{file:r,...e||t})}}function vr(e){if(e)throw e}var _t=Object.prototype.hasOwnProperty,Si=Object.prototype.toString,Cr=Object.defineProperty,Ir=Object.getOwnPropertyDescriptor,Nr=function(t){return typeof Array.isArray=="function"?Array.isArray(t):Si.call(t)==="[object Array]"},Er=function(t){if(!t||Si.call(t)!=="[object Object]")return!1;var n=_t.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&_t.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var i;for(i in t);return typeof i>"u"||_t.call(t,i)},Pr=function(t,n){Cr&&n.name==="__proto__"?Cr(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},Ar=function(t,n){if(n==="__proto__")if(_t.call(t,n)){if(Ir)return Ir(t,n).value}else return;return t[n]},gc=function e(){var t,n,r,i,o,a,s=arguments[0],l=1,u=arguments.length,c=!1;for(typeof s=="boolean"&&(c=s,s=arguments[1]||{},l=2),(s==null||typeof s!="object"&&typeof s!="function")&&(s={});l<u;++l)if(t=arguments[l],t!=null)for(n in t)r=Ar(s,n),i=Ar(t,n),s!==i&&(c&&i&&(Er(i)||(o=Nr(i)))?(o?(o=!1,a=r&&Nr(r)?r:[]):a=r&&Er(r)?r:{},Pr(s,{name:n,newValue:e(c,a,i)})):typeof i<"u"&&Pr(s,{name:n,newValue:i}));return s};const Gt=Dr(gc);function fn(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function yc(){const e=[],t={run:n,use:r};return t;function n(...i){let o=-1;const a=i.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);s(null,...i);function s(l,...u){const c=e[++o];let p=-1;if(l){a(l);return}for(;++p<i.length;)(u[p]===null||u[p]===void 0)&&(u[p]=i[p]);i=u,c?xc(c,s)(...u):a(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),t}}function xc(e,t){let n;return r;function r(...a){const s=e.length>a.length;let l;s&&a.push(i);try{l=e.apply(this,a)}catch(u){const c=u;if(s&&n)throw c;return i(c)}s||(l&&l.then&&typeof l.then=="function"?l.then(o,i):l instanceof Error?i(l):o(l))}function i(a,...s){n||(n=!0,t(a,...s))}function o(a){i(null,a)}}const Ve={basename:bc,dirname:wc,extname:Sc,join:kc,sep:"/"};function bc(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');St(e);let n=0,r=-1,i=e.length,o;if(t===void 0||t.length===0||t.length>e.length){for(;i--;)if(e.codePointAt(i)===47){if(o){n=i+1;break}}else r<0&&(o=!0,r=i+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let a=-1,s=t.length-1;for(;i--;)if(e.codePointAt(i)===47){if(o){n=i+1;break}}else a<0&&(o=!0,a=i+1),s>-1&&(e.codePointAt(i)===t.codePointAt(s--)?s<0&&(r=i):(s=-1,r=a));return n===r?r=a:r<0&&(r=e.length),e.slice(n,r)}function wc(e){if(St(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function Sc(e){St(e);let t=e.length,n=-1,r=0,i=-1,o=0,a;for(;t--;){const s=e.codePointAt(t);if(s===47){if(a){r=t+1;break}continue}n<0&&(a=!0,n=t+1),s===46?i<0?i=t:o!==1&&(o=1):i>-1&&(o=-1)}return i<0||n<0||o===0||o===1&&i===n-1&&i===r+1?"":e.slice(i,n)}function kc(...e){let t=-1,n;for(;++t<e.length;)St(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":vc(n)}function vc(e){St(e);const t=e.codePointAt(0)===47;let n=Cc(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function Cc(e,t){let n="",r=0,i=-1,o=0,a=-1,s,l;for(;++a<=e.length;){if(a<e.length)s=e.codePointAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=a,o=0;continue}}else if(n.length>0){n="",r=0,i=a,o=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,a):n=e.slice(i+1,a),r=a-i-1;i=a,o=0}else s===46&&o>-1?o++:o=-1}return n}function St(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const Ic={cwd:Nc};function Nc(){return"/"}function gn(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function Ec(e){if(typeof e=="string")e=new URL(e);else if(!gn(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return Pc(e)}function Pc(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(t)}const Jt=["history","path","basename","stem","extname","dirname"];class ki{constructor(t){let n;t?gn(t)?n={path:t}:typeof t=="string"||Ac(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":Ic.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Jt.length;){const o=Jt[r];o in n&&n[o]!==void 0&&n[o]!==null&&(this[o]=o==="history"?[...n[o]]:n[o])}let i;for(i in n)Jt.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?Ve.basename(this.path):void 0}set basename(t){Qt(t,"basename"),Xt(t,"basename"),this.path=Ve.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Ve.dirname(this.path):void 0}set dirname(t){Tr(this.basename,"dirname"),this.path=Ve.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Ve.extname(this.path):void 0}set extname(t){if(Xt(t,"extname"),Tr(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ve.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){gn(t)&&(t=Ec(t)),Qt(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Ve.basename(this.path,this.extname):void 0}set stem(t){Qt(t,"stem"),Xt(t,"stem"),this.path=Ve.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const i=this.message(t,n,r);throw i.fatal=!0,i}info(t,n,r){const i=this.message(t,n,r);return i.fatal=void 0,i}message(t,n,r){const i=new Ne(t,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Xt(e,t){if(e&&e.includes(Ve.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Ve.sep+"`")}function Qt(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Tr(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function Ac(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Tc=function(e){const r=this.constructor.prototype,i=r[e],o=function(){return i.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},_c={}.hasOwnProperty;class Ln extends Tc{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=yc()}copy(){const t=new Ln;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(Gt(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(tn("data",this.frozen),this.namespace[t]=n,this):_c.call(this.namespace,t)&&this.namespace[t]||void 0:t?(tn("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(t,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=At(t),r=this.parser||this.Parser;return Zt("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),Zt("process",this.parser||this.Parser),en("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(o,a){const s=At(t),l=r.parse(s);r.run(l,s,function(c,p,f){if(c||!p||!f)return u(c);const d=p,S=r.stringify(d,f);Oc(S)?f.value=S:f.result=S,u(c,f)});function u(c,p){c||!p?a(c):o?o(p):n(void 0,p)}}}processSync(t){let n=!1,r;return this.freeze(),Zt("processSync",this.parser||this.Parser),en("processSync",this.compiler||this.Compiler),this.process(t,i),Lr("processSync","process",n),r;function i(o,a){n=!0,vr(o),r=a}}run(t,n,r){_r(t),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?o(void 0,r):new Promise(o);function o(a,s){const l=At(n);i.run(t,l,u);function u(c,p,f){const d=p||t;c?s(c):a?a(d):r(void 0,d,f)}}}runSync(t,n){let r=!1,i;return this.run(t,n,o),Lr("runSync","run",r),i;function o(a,s){vr(a),i=s,r=!0}}stringify(t,n){this.freeze();const r=At(n),i=this.compiler||this.Compiler;return en("stringify",i),_r(t),i(t,r)}use(t,...n){const r=this.attachers,i=this.namespace;if(tn("use",this.frozen),t!=null)if(typeof t=="function")l(t,n);else if(typeof t=="object")Array.isArray(t)?s(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function o(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[c,...p]=u;l(c,p)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(u.plugins),u.settings&&(i.settings=Gt(!0,i.settings,u.settings))}function s(u){let c=-1;if(u!=null)if(Array.isArray(u))for(;++c<u.length;){const p=u[c];o(p)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,c){let p=-1,f=-1;for(;++p<r.length;)if(r[p][0]===u){f=p;break}if(f===-1)r.push([u,...c]);else if(c.length>0){let[d,...S]=c;const I=r[f][1];fn(I)&&fn(d)&&(d=Gt(!0,I,d)),r[f]=[u,d,...S]}}}}const Lc=new Ln().freeze();function Zt(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function en(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function tn(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function _r(e){if(!fn(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Lr(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function At(e){return Mc(e)?e:new ki(e)}function Mc(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function Oc(e){return typeof e=="string"||Dc(e)}function Dc(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const jc="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Mr=[],Or={allowDangerousHtml:!0},$c=/^(https?|ircs?|mailto|xmpp)$/i,Rc=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Fc(e){const t=zc(e),n=Bc(e);return Uc(t.runSync(t.parse(n),n),e)}function zc(e){const t=e.rehypePlugins||Mr,n=e.remarkPlugins||Mr,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Or}:Or;return Lc().use(wl).use(n).use(fc,r).use(t)}function Bc(e){const t=e.children||"",n=new ki;return typeof t=="string"&&(n.value=t),n}function Uc(e,t){const n=t.allowedElements,r=t.allowElement,i=t.components,o=t.disallowedElements,a=t.skipHtml,s=t.unwrapDisallowed,l=t.urlTransform||Vc;for(const c of Rc)Object.hasOwn(t,c.from)&&(""+c.from+(c.to?"use `"+c.to+"` instead":"remove it")+jc+c.id,void 0);return t.className&&(e={type:"element",tagName:"div",properties:{className:t.className},children:e.type==="root"?e.children:[e]}),wi(e,u),Zo(e,{Fragment:g.Fragment,components:i,ignoreInvalidStyle:!0,jsx:g.jsx,jsxs:g.jsxs,passKeys:!0,passNode:!0});function u(c,p,f){if(c.type==="raw"&&f&&typeof p=="number")return a?f.children.splice(p,1):f.children[p]={type:"text",value:c.value},p;if(c.type==="element"){let d;for(d in qt)if(Object.hasOwn(qt,d)&&Object.hasOwn(c.properties,d)){const S=c.properties[d],I=qt[d];(I===null||I.includes(c.tagName))&&(c.properties[d]=l(String(S||""),d,c))}}if(c.type==="element"){let d=n?!n.includes(c.tagName):o?o.includes(c.tagName):!1;if(!d&&r&&typeof p=="number"&&(d=!r(c,p,f)),d&&f&&typeof p=="number")return s&&c.children?f.children.splice(p,1,...c.children):f.children.splice(p,1),p}}}function Vc(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),i=e.indexOf("/");return t===-1||i!==-1&&t>i||n!==-1&&t>n||r!==-1&&t>r||$c.test(e.slice(0,t))?e:""}const Hc={skyrim:["skyrim","tes v","tes 5","elder scrolls 5"],oblivion:["oblivion","tes iv","tes 4","elder scrolls 4"],morrowind:["morrowind","tes iii","tes 3","elder scrolls 3"],newvegas:["new vegas","fnv","vegas"],fo3:["fallout 3","fo3"],fo76:["fallout 76","fo76"],minecraft:["minecraft","mods for minecraft"],witcher:["witcher","witcher 3","tw3"],baldurs:["baldurs gate","baldur's gate","bg3"],starfield:["starfield"],cyberpunk:["cyberpunk","cd projekt"],elden:["elden ring"],sims:["sims 4","sims 5"],stardew:["stardew valley"],rimworld:["rimworld"],valheim:["valheim"],terraria:["terraria"]},Yc=["fallout 4","fo4","fallout iv","fo4 modding","papyrus","creation kit","nif","esp","esm","quest","vault","pip-boy","institute","bos","railroad","minutemen","synth","commonwealth","settlement"];function qc(e){const t=e.toLowerCase();for(const[r,i]of Object.entries(Hc))for(const o of i)if(t.includes(o))return{allowed:!1,reason:`other_game_${r}`,message:`I appreciate your interest, but I'm specialized for **Fallout 4 modding only**. I can't help with ${r.replace(/_/g," ")} or other games.

If you're interested in modding for other games, future versions of me will be available for:
- The Elder Scrolls series (Skyrim, Oblivion, Morrowind)
- Fallout: New Vegas
- Other games

For now, I'm here exclusively for your Fallout 4 modding needs. What can I help you with in Fallout 4?`};return!Yc.some(r=>t.includes(r))&&!Wc(e)&&Kc(e)?{allowed:!1,reason:"completely_off_topic",message:`I'm Mossy, your **Fallout 4 modding AI assistant**. I'm specialized in helping with:

- ðŸ“œ Papyrus scripting
- ðŸŽ¨ 3D mesh creation and optimization
- ðŸ—ºï¸ Quest and worldspace design
- ðŸ”§ Mod management and troubleshooting
- ðŸ“š Modding documentation

I can't help with topics outside of Fallout 4 modding. What Fallout 4 project can I help you with today?`}:{allowed:!0}}function Wc(e){const t=e.toLowerCase();return["script","mesh","quest","mod","nif","texture","animation","dialogue","plugin","creation kit","papyrus","blender","xedit","wrye","nifskope","optimization","performance","worldspace","cell","npc","armor","weapon","clothing","mutagen","conflict","esp","esm"].some(r=>t.includes(r))}function Kc(e){const t=e.toLowerCase();return["how do i cook","recipe","what's the weather","tell me a joke","what's 2+2","how to build a house","car repair","how to fix my","tax advice","medical","health","recipe","cooking"].some(r=>t.includes(r))}const Gc=({onSubmit:e,onCancel:t})=>{const[n,r]=X.useState(""),[i,o]=X.useState(""),[a,s]=X.useState([]),l=[{id:"quest",label:"Quest / Story",icon:Ki},{id:"asset",label:"Asset Replacer",icon:nn},{id:"script",label:"Scripting",icon:rn},{id:"world",label:"Worldspace",icon:zr},{id:"gameplay",label:"Gameplay",icon:Ei},{id:"ui",label:"Interface",icon:qi}],u=p=>{s(f=>f.includes(p)?f.filter(d=>d!==p):[...f,p])},c=()=>{n&&e({name:n,description:i,categories:a})};return g.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl p-6 shadow-2xl animate-slide-up w-full max-w-2xl mx-auto",children:[g.jsxs("div",{className:"flex justify-between items-start mb-6",children:[g.jsxs("div",{children:[g.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[g.jsx(Di,{className:"w-5 h-5 text-emerald-400"}),"Initialize Project"]}),g.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Configure workspace parameters for new mod."})]}),g.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:g.jsx(Rr,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"space-y-4 mb-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Project Name"}),g.jsx("input",{type:"text",value:n,onChange:p=>r(p.target.value),placeholder:"e.g. 'Project Cobalt', 'Wasteland Flora Overhaul'",className:"w-full bg-slate-800 border border-slate-600 rounded-lg px-4 py-2 text-white focus:border-emerald-500 focus:outline-none transition-colors",autoFocus:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Description"}),g.jsx("textarea",{value:i,onChange:p=>o(p.target.value),placeholder:"Brief overview of the mod's goals...",className:"w-full h-20 bg-slate-800 border border-slate-600 rounded-lg px-4 py-2 text-white focus:border-emerald-500 focus:outline-none resize-none transition-colors text-sm"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-2",children:"Primary Modules"}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:l.map(p=>g.jsxs("button",{onClick:()=>u(p.id),className:`flex items-center gap-2 p-2 rounded-lg border text-xs font-medium transition-all ${a.includes(p.id)?"bg-emerald-900/30 border-emerald-500 text-emerald-400":"bg-slate-800 border-transparent text-slate-400 hover:border-slate-600"}`,children:[g.jsx(p.icon,{className:"w-4 h-4"}),p.label]},p.id))})]})]}),g.jsxs("div",{className:"flex-end gap-3 pt-4 border-t border-slate-800 flex justify-end",children:[g.jsx("button",{onClick:t,className:"px-4 py-2 text-slate-400 hover:text-white text-sm font-bold transition-colors",children:"Cancel"}),g.jsxs("button",{onClick:c,disabled:!n,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-sm font-bold flex items-center gap-2 shadow-lg shadow-emerald-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[g.jsx($r,{className:"w-4 h-4"}),"Create Workspace"]})]})]})},Jc=jr.memo(({msg:e,onboardingState:t,scanProgress:n,detectedApps:r,projectContext:i,handleIntegrate:o,handleStartProject:a,onManualExecute:s})=>{var u,c,p;const l=()=>{if(!e.toolCall||e.toolCall.toolName!=="execute_blender_script")return"";const f=e.toolCall.args.script;return f.includes("primitive_cube_add")||f.includes("create_cube")?"# AUTO-OPTIMIZED: Delegating to 'MOSSY_CUBE' internal function for reliability.":yn(f)};return g.jsx("div",{className:`flex ${e.role==="user"?"justify-end":"justify-start"}`,children:g.jsxs("div",{className:`max-w-[85%] lg:max-w-[75%] rounded-2xl p-4 shadow-sm ${e.role==="user"?"bg-emerald-600 text-white rounded-tr-none":e.role==="system"?"bg-slate-800 border border-slate-700 text-slate-400 text-sm":"bg-forge-panel border border-slate-700 rounded-tl-none"}`,children:[e.images&&e.images.map((f,d)=>g.jsx("img",{src:f,alt:"Uploaded",className:"max-w-full h-auto rounded mb-2 border border-black/20"},d)),g.jsx("div",{className:"markdown-body text-sm leading-relaxed",children:g.jsx(Fc,{children:e.text})}),e.toolCall&&e.toolCall.toolName==="execute_blender_script"&&g.jsxs("div",{className:"mt-3 bg-slate-900 border border-emerald-500/30 rounded-xl p-3 animate-slide-up",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs font-bold text-emerald-400 uppercase tracking-wide",children:[g.jsx(on,{className:"w-3 h-3"})," Ready to Execute"]}),g.jsx("div",{className:"bg-black/50 p-2 rounded border border-slate-800 font-mono text-xs text-slate-300 max-h-32 overflow-y-auto mb-3",children:l()}),g.jsx("div",{className:"text-[10px] text-slate-500 mb-2 italic",children:"Click 'Run Command' to send to clipboard. If auto-run fails, use 'Paste & Run' in Blender."}),g.jsxs("button",{onClick:()=>s(e.toolCall.toolName,e.toolCall.args),className:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded-lg text-xs flex items-center justify-center gap-2 transition-colors shadow-lg",children:[g.jsx(ji,{className:"w-3 h-3 fill-current"})," Run Command"]})]}),e.toolCall&&e.toolCall.toolName!=="execute_blender_script"&&g.jsxs("div",{className:"mt-3 bg-slate-900/50 border border-slate-700 rounded-xl p-3 animate-slide-up",children:[g.jsxs("div",{className:"flex justify-between items-center mb-2",children:[g.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:[g.jsx(on,{className:"w-3 h-3"})," System Bridge"]}),g.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 border rounded text-[9px] font-bold ${((u=e.toolResult)==null?void 0:u.success)!==!1?"bg-emerald-900/30 border-emerald-500/30 text-emerald-400":"bg-red-900/30 border-red-500/30 text-red-400"}`,children:((c=e.toolResult)==null?void 0:c.success)!==!1?"EXECUTED":"FAILED"})]}),g.jsxs("div",{className:"flex items-center justify-between gap-3",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"text-[11px] font-mono text-white truncate",children:[e.toolCall.toolName,"(",Object.entries(e.toolCall.args||{}).map(([f,d])=>`${f}="${d}"`).join(", "),")"]}),e.toolResult&&g.jsx("div",{className:"text-[10px] text-slate-500 mt-1 italic border-l border-slate-700 pl-2",children:typeof e.toolResult=="string"?e.toolResult.length>100?e.toolResult.substring(0,100)+"...":e.toolResult:((p=e.toolResult.result)==null?void 0:p.length)>100?e.toolResult.result.substring(0,100)+"...":e.toolResult.result})]}),g.jsx("button",{onClick:()=>s(e.toolCall.toolName,e.toolCall.args),className:"p-2 bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-emerald-400 rounded-lg border border-slate-700 transition-colors",title:"Re-run tool command",children:g.jsx(RotateCcw,{className:"w-3 h-3"})})]})]}),t==="scanning"&&e.role==="model"&&e.text.includes("Scan")&&g.jsxs("div",{className:"mt-4 bg-slate-900 rounded-lg p-3 border border-slate-700 animate-slide-up",children:[g.jsxs("div",{className:"flex justify-between text-xs mb-1 text-emerald-400 font-mono",children:[g.jsx("span",{children:"PIP-BOY DIAGNOSTIC"}),g.jsxs("span",{children:[n,"%"]})]}),g.jsx("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden",children:g.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-100",style:{width:`${n}%`}})}),g.jsx("div",{className:"mt-2 text-[10px] text-slate-500 font-mono truncate",children:"Probing Data/F4SE/Plugins..."})]}),t==="integrating"&&e.role==="model"&&e.text.includes("Scan Complete")&&g.jsxs("div",{className:"mt-4 bg-slate-900 rounded-xl p-4 border border-slate-700 shadow-inner animate-slide-up",children:[g.jsxs("h4",{className:"text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider flex items-center gap-2",children:[g.jsx($i,{className:"w-3 h-3"})," Detected Tools"]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:r.map(f=>g.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer border transition-all ${f.checked?"bg-emerald-900/20 border-emerald-500/50":"bg-slate-800 border-transparent hover:border-slate-600"}`,children:[g.jsx("div",{className:"w-3 h-3 rounded bg-emerald-500"}),g.jsx("span",{className:"text-xs font-medium text-slate-200",children:f.name})]},f.id))}),g.jsx("button",{onClick:o,className:"w-full py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg font-bold text-xs uppercase tracking-wide transition-colors",children:"Link & Integrate"})]}),e.id==="integrated"&&t==="ready"&&!i&&g.jsx("div",{className:"mt-4 flex flex-col gap-2",children:g.jsxs("button",{onClick:a,className:"flex items-center gap-3 p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500/50 rounded-xl text-left transition-all group",children:[g.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg group-hover:bg-emerald-500/30",children:g.jsx(Fr,{className:"w-5 h-5 text-emerald-400"})}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-bold text-slate-200",children:"Start New Mod"}),g.jsx("div",{className:"text-xs text-slate-500",children:"Create workspace for ESP/ESL"})]}),g.jsx(Ti,{className:"w-4 h-4 text-slate-600 ml-auto group-hover:text-emerald-400"})]})}),e.sources&&e.sources.length>0&&g.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600/50 text-xs flex flex-wrap gap-2",children:e.sources.map((f,d)=>g.jsxs("a",{href:f.uri,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 bg-black/20 hover:bg-black/40 px-2 py-1 rounded text-emerald-300 truncate max-w-[150px]",children:[g.jsx(zr,{className:"w-3 h-3"})," ",f.title]},d))})]})})}),Xc=jr.memo(({messages:e,...t})=>g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 scroll-smooth",children:[e.map(n=>g.jsx(Jc,{msg:n,...t},n.id)),t.children]})),pu=()=>{let e=null;try{e=Ii()}catch{console.warn("[ChatInterface] LiveContext not available, using fallback"),e={isActive:!1,isMuted:!1,toggleMute:()=>{},disconnect:()=>{}}}const{isActive:t,isMuted:n,toggleMute:r,disconnect:i}=e,[o,a]=X.useState([]),[s,l]=X.useState("Initializing modding education protocol..."),[u,c]=X.useState(""),[p,f]=X.useState(!1),[d,S]=X.useState(!1),[I,F]=X.useState(null),P=X.useRef(null),[U,R]=X.useState(()=>t?!1:localStorage.getItem("mossy_voice_enabled")==="true"),[ne,se]=X.useState(!1),[N,y]=X.useState(!1),[b,_]=X.useState(!1),[C,v]=X.useState([]),[k,w]=X.useState(!1),[O,T]=X.useState(null),[D,B]=X.useState("init"),[z,K]=X.useState(0),[h,me]=X.useState([]),[G,m]=X.useState(null),[fe,be]=X.useState(null),[ie,$e]=X.useState(null),[Pe,Ae]=X.useState(!1),[Ee,dt]=X.useState(()=>{try{const M=localStorage.getItem("mossy_system_profile");return M?JSON.parse(M):null}catch{return null}}),[pt,Ft]=X.useState([]),[Mn,kt]=X.useState(null),[nt,vt]=X.useState([]),Ct=X.useRef(null),qe=X.useRef(null),Re=X.useRef(null);X.useEffect(()=>{const M=setTimeout(()=>{if(o.length>0)try{localStorage.setItem("mossy_messages",JSON.stringify(o))}catch(j){console.error("Failed to save history (Quota Exceeded?)",j)}localStorage.setItem("mossy_working_memory",s)},2e3);return()=>clearTimeout(M)},[o,s]),X.useEffect(()=>{const M=()=>{var Z;const j=localStorage.getItem("mossy_bridge_active")==="true";_(j);try{const re=JSON.parse(localStorage.getItem("mossy_bridge_drivers")||"[]");v(re)}catch{}const oe=localStorage.getItem("mossy_blender_active")==="true";if(w(oe),j){const re=localStorage.getItem("mossy_last_scan"),J=Date.now(),we=24*60*60*1e3;localStorage.getItem("mossy_apps")?D!=="init"&&D!=="scanning"&&D!=="integrating"&&(!re||J-parseInt(re)>we)&&W(!0):(console.log("[ChatInterface] No scan data found; running auto-scan..."),D==="init"?W():W(!0))}const te=((Z=window.electron)==null?void 0:Z.api)||window.electronAPI;te!=null&&te.getSettings&&te.getSettings().then(m).catch(()=>{});const ge=re=>{console.log("[ChatInterface] Settings updated via broadcast, refreshing..."),te!=null&&te.getSettings&&te.getSettings().then(m).catch(()=>{})};window.addEventListener("mossy-settings-updated",ge);try{const re=localStorage.getItem("mossy_scan_auditor");re&&Ft(JSON.parse(re));const J=localStorage.getItem("mossy_scan_cartographer");J&&kt(JSON.parse(J));const we=localStorage.getItem("mossy_cortex_memory");we&&vt(JSON.parse(we))}catch{}return()=>{window.removeEventListener("mossy-settings-updated",ge)}};M(),window.addEventListener("focus",M),window.addEventListener("mossy-memory-update",M),window.addEventListener("mossy-bridge-connected",M),window.addEventListener("mossy-driver-update",M),window.addEventListener("mossy-blender-linked",M),window.addEventListener("storage",M);try{const j=localStorage.getItem("mossy_messages"),oe=localStorage.getItem("mossy_state"),te=localStorage.getItem("mossy_project"),ge=localStorage.getItem("mossy_apps"),Z=localStorage.getItem("mossy_voice_enabled"),re=localStorage.getItem("mossy_working_memory");if(j?a(JSON.parse(j)):ht(),re&&l(re),oe&&B(JSON.parse(oe)),te){const J=JSON.parse(te);be(J.name),$e(J),Ae(!0)}ge&&me(JSON.parse(ge)),Z&&!t&&R(JSON.parse(Z))}catch(j){console.error("Load failed",j),ht()}return()=>{if(window.removeEventListener("focus",M),window.removeEventListener("mossy-memory-update",M),window.removeEventListener("mossy-bridge-connected",M),window.removeEventListener("mossy-driver-update",M),Re.current)try{Re.current.stop(),Re.current.disconnect()}catch{}qe.current&&(qe.current.close(),qe.current=null)}},[]),X.useEffect(()=>{localStorage.setItem("mossy_state",JSON.stringify(D)),h.length>0&&localStorage.setItem("mossy_apps",JSON.stringify(h)),localStorage.setItem("mossy_voice_enabled",JSON.stringify(U)),ie?localStorage.setItem("mossy_project",JSON.stringify(ie)):localStorage.removeItem("mossy_project")},[D,h,ie,U]),X.useEffect(()=>{t&&(U&&R(!1),N&&rt())},[t]);const ht=()=>{if(localStorage.getItem("mossy_apps")){a([{id:"init",role:"model",text:`ðŸ‘‹ **Welcome back, Vault Dweller!**

My neural link is active and I've loaded your system profile. I'm ready to assist with your Fallout 4 project. What are we working on today?`}]),B("ready");return}a([{id:"init",role:"model",text:`ðŸ‘‹ **Hello, Vault Dweller!**

I'm **Mossy**, your dedicated AI assistant for Fallout 4 modding.

To provide the best assistance, I need to perform a **Deep Scan** to identify your modding tools (Creation Kit, xEdit, Blender, etc.) across all your system drives. I will remember these so we only need to do this once.

**Ready to begin the scan?**`}]),B("init")},zt=()=>{window.confirm("Perform Chat Reset? This will clear the conversation history and current project state, but keep global settings (Avatar, Bridge, Tutorial).")&&(localStorage.removeItem("mossy_messages"),localStorage.removeItem("mossy_state"),localStorage.removeItem("mossy_project"),localStorage.removeItem("mossy_apps"),localStorage.removeItem("mossy_scan_auditor"),localStorage.removeItem("mossy_scan_cartographer"),localStorage.removeItem("mossy_cortex_memory"),a([]),be(null),$e(null),me([]),ht(),Ae(!1))},Bt=()=>{t||(U&&rt(),R(!U))},rt=()=>{if(Re.current){try{Re.current.stop(),Re.current.disconnect()}catch{}Re.current=null}y(!1)},Ut=()=>{if(t){alert("Live Voice is currently active. Please disconnect Live Voice to use the chat microphone.");return}const M=window.SpeechRecognition||window.webkitSpeechRecognition;if(!M){alert("Audio receptors damaged. (Browser not supported)");return}const j=new M;j.continuous=!1,j.interimResults=!1,j.lang="en-US";let oe=null,te=null,ge=null,Z=null,re=0;const J=.01,we=500,Ie=async()=>{try{ge=await navigator.mediaDevices.getUserMedia({audio:!0}),oe=new(window.AudioContext||window.webkitAudioContext),te=oe.createAnalyser(),te.fftSize=2048,oe.createMediaStreamSource(ge).connect(te);const ye=new Uint8Array(te.frequencyBinCount),E=()=>{if(!te)return;if(te.getByteFrequencyData(ye),ye.reduce((ce,ue)=>ce+ue)/ye.length/255<J){if(re+=50,re>=we){console.log("[ChatInterface] Silence detected - stopping speech recognition"),j.abort();return}}else re=0;Z=setTimeout(E,50)};Z=setTimeout(E,50)}catch(Q){console.warn("[ChatInterface] Silence detection setup failed:",Q)}};j.onstart=()=>{se(!0),Ie()},j.onresult=Q=>{c(ye=>ye+(ye?" ":"")+Q.results[0][0].transcript)},j.onerror=()=>{se(!1),Z&&clearTimeout(Z),ge&&ge.getTracks().forEach(Q=>Q.stop()),oe&&oe.close()},j.onend=()=>{se(!1),Z&&clearTimeout(Z),ge&&ge.getTracks().forEach(Q=>Q.stop()),oe&&oe.close()},j.start()},x=async M=>{var oe,te,ge,Z,re,J;if(!M||t)return;const j=M.replace(/[*#]/g,"").substring(0,500);y(!0);try{const we="AIzaSyB0n0hMsy-ilO2znsdTb0exWJt3L-UtAv4",$=(J=(re=(Z=(ge=(te=(oe=(await(await new Fn({apiKey:we}).getGenerativeModel({model:"gemini-1.5-flash"}).generateContent({contents:[{role:"user",parts:[{text:j}]}],generationConfig:{responseModalities:[_i.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).response).candidates)==null?void 0:oe[0])==null?void 0:te.content)==null?void 0:ge.parts)==null?void 0:Z[0])==null?void 0:re.inlineData)==null?void 0:J.data;if(!$)throw new Error("No audio returned");qe.current||(qe.current=new(window.AudioContext||window.webkitAudioContext));const ee=qe.current;ee.state==="suspended"&&await ee.resume();const ce=atob($),ue=ce.length;let ze;if(ue>10*1024*1024)ze=await new Promise((de,Se)=>{try{const ve=new Uint8Array(ue),xe=65536;let We=0;const it=()=>{const Ue=Math.min(We+xe,ue);for(let Ke=We;Ke<Ue;Ke++)ve[Ke]=ce.charCodeAt(Ke)&255;if(We=Ue,We<ue)setTimeout(it,0);else{const Ke=new Int16Array(ve.buffer),On=ee.createBuffer(1,Ke.length,24e3),vi=On.getChannelData(0);let It=0;const Ci=32768,Dn=()=>{const jn=Math.min(It+Ci,Ke.length);for(let Nt=It;Nt<jn;Nt++)vi[Nt]=Ke[Nt]/32768;It=jn,It<Ke.length?setTimeout(Dn,0):de(On)};Dn()}};it()}catch(ve){Se(ve)}});else{const de=new Uint8Array(ue);for(let xe=0;xe<ue;xe++)de[xe]=ce.charCodeAt(xe)&255;const Se=new Int16Array(de.buffer);ze=ee.createBuffer(1,Se.length,24e3);const ve=ze.getChannelData(0);for(let xe=0;xe<Se.length;xe++)ve[xe]=Se[xe]/32768}const Y=ee.createBufferSource();Y.buffer=ze,Y.connect(ee.destination),Re.current=Y,Y.onended=()=>{try{Y.disconnect()}catch{}y(!1),Re.current=null},Y.start()}catch(we){console.error("TTS Error",we),y(!1)}},L=()=>{try{let M="Hardware: Unknown";Ee&&(M=`**Spec:** ${Ee.gpu} | ${Ee.ram}GB RAM | Blender ${Ee.blenderVersion}`);let j="";try{const E=typeof window<"u"?window.localStorage.getItem("mossy_knowledge_vault"):null;if(E){const $=JSON.parse(E);if(Array.isArray($)&&$.length>0){const ee=$.map(ce=>{var ue;return`[${((ue=ce.tags)==null?void 0:ue.join(", "))||"general"}] ${ce.title}: ${ce.content.substring(0,200)}${ce.content.length>200?"...":""}`}).join(`
`);j=`
**MOSSY'S KNOWLEDGE VAULT (${$.length} items - CRITICAL CONTEXT):**
${ee}`}}}catch(E){console.warn("[ChatInterface] Failed to load memory vault:",E)}let oe="";try{const E=typeof window<"u"?window.localStorage.getItem("vault-assets-v1"):null;if(E){const $=JSON.parse(E);Array.isArray($)&&$.length>0&&(oe=`
**VAULT ASSETS (Ready for Ingestion):**
${$.map(ce=>`- ${ce.name} (${ce.type}${ce.type==="script"&&(ce.name.toLowerCase().endsWith(".bat")||ce.name.toLowerCase().endsWith(".cmd"))?" - batch script":""})`).join(`
`)}`)}}catch(E){console.warn("[ChatInterface] Failed to load vault assets:",E)}let te="";pt&&pt.length>0&&(te+=`
**THE AUDITOR - RECENT SCAN RESULTS:**
`,pt.forEach(E=>{te+=`- File: ${E.name} (Status: ${E.status.toUpperCase()})
`,E.issues&&E.issues.length>0&&E.issues.forEach($=>{te+=`  * ERROR: ${$.message}
  * DETAILS: ${$.technicalDetails}
`})}));let ge="";if(nt&&nt.length>0){const E=nt.filter($=>$.status==="indexed").map($=>`- [${$.type.toUpperCase()}] ${$.name}: ${$.summary||"Content ingested."}`).join(`
`);E&&(ge=`
**INGESTED KNOWLEDGE (TUTORIALS & DOCS):**
${E}
(Use this knowledge to answer user queries accurately based on the provided documents.)`)}let Z="";try{const{ModProjectStorage:E}=require("./services/ModProjectStorage"),$=E.getCurrentMod();if($){const ee=E.getProjectStats($.id);Z=`
**CURRENT MOD PROJECT:** "${$.name}"
- Type: ${$.type} | Status: ${$.status}
- Progress: ${$.completionPercentage}% | Steps: ${ee.completedSteps}/${ee.totalSteps}
- Version: ${$.version}
(Provide context-aware guidance for this specific mod.)`}}catch{}const re=b?"ONLINE":"OFFLINE",J=k?`**BLENDER LINK: ACTIVE (v4.0 Clipboard Relay)**
You can execute Python scripts in Blender.
IMPORTANT: Tell the user they MUST click the 'Run Command' button that appears in the chat to execute the script.`:`**BLENDER LINK: OFFLINE**
(If the user asks to control Blender, tell them to go to the Desktop Bridge and install the 'Mossy Link v4.0' add-on first.)`;let we="";if(G){const E=G;we=`
**USER OVERRIDE SETTINGS (HIGHEST PRIORITY):**
`+(E.fallout4Path?`- **Fallout 4 Game Folder:** ${E.fallout4Path}
`:"")+(E.mo2Path?`- MO2/ModOrganizer: ${E.mo2Path}
`:"")+(E.xeditPath?`- FO4Edit/XEdit: ${E.xeditPath}
`:"")+(E.wryeBashPath?`- Wrye Bash: ${E.wryeBashPath}
`:"")+(E.vortexPath?`- Vortex: ${E.vortexPath}
`:"")+(E.bodySlidePath?`- BodySlide: ${E.bodySlidePath}
`:"")+(E.outfitStudioPath?`- Outfit Studio: ${E.outfitStudioPath}
`:"")+(E.creationKitPath?`- Creation Kit: ${E.creationKitPath}
`:"")+(E.nifSkopePath?`- NifSkope: ${E.nifSkopePath}
`:"")+(E.blenderPath?`- Blender: ${E.blenderPath}
`:"")}const Ie=(h||[]).filter(E=>{var $,ee;return E.name.toLowerCase().includes("fallout 4")||(($=E.displayName)==null?void 0:$.toLowerCase().includes("fallout 4"))||((ee=E.path)==null?void 0:ee.toLowerCase().includes("fallout 4"))}),Q=Ie.length>0?`
**FALLOUT 4 INSTALLATIONS (${Ie.length} found):**
`+Ie.map((E,$)=>{var ue,ze,Y,de,Se;const ee=((ue=E.path)==null?void 0:ue.charAt(0).toUpperCase())||"?",ce=(ze=E.path)!=null&&ze.toLowerCase().includes("steam")?"[STEAM]":(Y=E.path)!=null&&Y.toLowerCase().includes("gog")?"[GOG]":(de=E.path)!=null&&de.toLowerCase().includes("xbox")||(Se=E.path)!=null&&Se.toLowerCase().includes("microsoft")?"[XBOX/MS STORE]":"";return`  ${$+1}. ${ce} ${ee}: drive - ${E.path}
     Data folder: ${E.path}\\Data`}).join(`
`):`
**FALLOUT 4 NOT DETECTED** - User may need to manually specify game folder in External Tools Settings.`,ye=`
**OMNIFORGE MODULES (Built-in):**
`+["â€¢ Image Studio (/images): PBR Map Synthesizer and Format Converter. Fallout 4 profile uses: _d â†’ BC7, _n â†’ BC5, _s â†’ BC5.","â€¢ The Auditor (/auditor): Scans ESP/ESM, NIF, DDS, BGSM with native file pickers; reports issues and basic auto-fixes.","â€¢ The Vault (/vault): Asset library + BA2 staging, presets, and external tool paths (texconv, xWMAEncode, PapyrusCompiler, gfxexport, splicer).","â€¢ Workshop (/workshop): Real file browser and editor; Papyrus compile via configured compiler path.","â€¢ Holodeck (/holodeck): Automated mod validator; integrates with Neural Link to monitor live gameplay.","â€¢ System Monitor (/system): Hardware and tools scan, Desktop Bridge status, launch helpers.","â€¢ The Scribe (/scribe): Documentation and readme assistant (Gemini-backed)."].join(`
`);return`
      **DYNAMIC SYSTEM CONTEXT:**
      **Desktop Bridge:** ${re}
      ${J}
            ${we}${Q}
            ${ye}
      **Short-Term Working Memory:** ${s}
      **Project Status:** ${ie?ie.name:"None"}${Z}
      ${j}
      ${oe}
      **Detected Tools:** ${(h||[]).filter(E=>E.path).map(E=>`${E.name} [ID: ${E.id}] (Path: ${E.path})`).join(", ")||"None"}
      ${M}
      ${te}
      ${ge}
      `}catch(M){return console.error("Context Error:",M),"Context: Error gathering system telemetry."}},H=()=>{var M;return(M=Ct.current)==null?void 0:M.scrollIntoView({behavior:"smooth"})};X.useEffect(H,[o,z,D,O,d]);const W=async(M=!1)=>{var te,ge,Z,re;if(D==="scanning"||D==="integrating")return;M||(B("scanning"),K(0));let j=0;const oe=M?null:setInterval(()=>{j+=2,j<=90&&K(j)},100);try{const J=[];try{const Q=await window.electronAPI.getSettings();[{name:"xEdit",path:Q.xeditPath,cat:"Tool"},{name:"NifSkope",path:Q.nifSkopePath,cat:"Tool"},{name:"Creation Kit",path:Q.creationKitPath,cat:"Official"},{name:"Blender",path:Q.blenderPath,cat:"3D"},{name:"LOOT",path:Q.lootPath,cat:"Manager"},{name:"Vortex",path:Q.vortexPath,cat:"Manager"},{name:"MO2",path:Q.mo2Path,cat:"Manager"},{name:"F4SE",path:Q.f4sePath,cat:"System"},{name:"BodySlide",path:Q.bodySlidePath,cat:"Tool"},{name:"GIMP",path:Q.gimpPath,cat:"Creative"},{name:"BAE",path:Q.baePath,cat:"Archive"},{name:"Archive2",path:Q.archive2Path,cat:"Archive"}].forEach(E=>{E.path&&E.path.length>3&&J.push({id:`manual-${Math.random().toString(36).substr(2,5)}`,name:E.name,category:E.cat,checked:!0,path:E.path})})}catch(Q){console.warn("Failed to merge settings into scan",Q)}if(typeof((ge=(te=window.electron)==null?void 0:te.api)==null?void 0:ge.detectPrograms)=="function"){const Q=await window.electron.api.detectPrograms(),ye=["blender","creationkit","fo4edit","xedit","sseedit","tes5edit","fnvedit","tes4edit","modorganizer","vortex","nifskope","bodyslide","f4se","loot","wryebash","outfitstudio","archive2","gimp","photoshop","zedit","bae","pjm","bethini","reshade","enb","cathedral","modsel","texconv","unpacker","material","bgsm","facegen","lipgen","papyrus","caprica","script","fallout","morrowind","oblivion","skyrim","starfield","game","mod"];Q.forEach(E=>{var ce;const $=E.name.toLowerCase(),ee=E.displayName.toLowerCase();if(ye.some(ue=>$.includes(ue)||ee.includes(ue))){const ue=J.findIndex(Y=>Y.name.toLowerCase()===E.displayName.toLowerCase()),ze=E.path&&!E.path.startsWith("C:");ue===-1?J.push({id:Math.random().toString(36).substr(2,9),name:E.displayName.length>3?E.displayName:E.name,displayName:E.displayName,category:($+ee).includes("blender")?"3D":($+ee).includes("creation")?"Official":($+ee).includes("modorganizer")||($+ee).includes("vortex")||($+ee).includes("loot")?"Manager":($+ee).includes("gimp")||($+ee).includes("photoshop")?"Creative":($+ee).includes("archive")||($+ee).includes("bae")?"Archive":"Tool",checked:!0,path:E.path,version:E.version}):ze&&((ce=J[ue].path)!=null&&ce.startsWith("C:"))&&(J[ue].path=E.path)}})}typeof((re=(Z=window.electron)==null?void 0:Z.api)==null?void 0:re.getRunningProcesses)=="function"&&(await window.electron.api.getRunningProcesses()).forEach(ye=>{const E=ye.name.toLowerCase();moddingKeywords.some($=>E.includes($))&&(J.some($=>$.name.toLowerCase().includes(E)||E.includes($.name.toLowerCase()))||J.push({id:`running-${Math.random().toString(36).substr(2,5)}`,name:ye.windowTitle||ye.name,category:"Running",checked:!0}))}),J.length===0&&!M&&console.log("No tools found during scan."),oe&&clearInterval(oe),M||K(100);const we=localStorage.getItem("mossy_apps");let Ie=[...J];if(we)try{JSON.parse(we).forEach(E=>{Ie.some($=>$.path===E.path||$.name===E.name)||Ie.push(E)});const ye={};Ie.forEach(E=>{const $=E.name.split(" - ")[0].toLowerCase(),ee=E.path&&!E.path.toLowerCase().startsWith("c:");(!ye[$]||ee&&ye[$].path.toLowerCase().startsWith("c:"))&&(ye[$]=E)}),Ie=Object.values(ye)}catch{}me(Ie),localStorage.setItem("mossy_apps",JSON.stringify(Ie)),localStorage.setItem("mossy_last_scan",Date.now().toString()),M||setTimeout(()=>{B("integrating"),a(Q=>[...Q,{id:`scan-done-${Date.now()}`,role:"model",text:J.length>2?`**Deep Scan Complete.** I located **${J.length}** modding tools across your drives. I will remember these for future sessions so we don't need to scan every time.`:"**Deep Scan Complete.** I couldn't find many tools automatically. You might need to link them manually in the 'Vault' or 'Bridge' settings."}])},500)}catch(J){console.error("System scan failed:",J),oe&&clearInterval(oe),M||B("ready")}},le=()=>{B("ready"),a(M=>[...M,{id:"integrated",role:"model",text:`Tools Linked. Creation Kit telemetry active.

**Ad Victoriam, modder.** What are we building today?`}])},Oe=()=>{B("project_setup"),a(M=>[...M,{id:"proj-start",role:"model",text:"Initializing new Workspace configuration protocol..."}])},Be=M=>{const j={name:M.name,status:"Pre-Production",notes:M.description,timestamp:new Date().toLocaleDateString(),keyDecisions:[],categories:M.categories};return $e(j),be(M.name),Ae(!0),j},Te=async(M,j)=>{await Ht.recordAction("tool_execution",{tool:M,args:j}),T({id:Date.now().toString(),toolName:M,args:j,status:"running"});const oe=await Zi(M,j,{isBlenderLinked:k});return T(null),oe},Qe=async(M,j)=>{if(M==="execute_blender_script")try{const te=`${yn(j.script)}
# ID: ${Date.now()}`;await navigator.clipboard.writeText(`MOSSY_CMD:${te}`),await Te(M,j)}catch(oe){console.error("Manual execute failed",oe)}else await Te(M,j)},Ze=()=>{P.current&&(P.current.abort(),P.current=null),f(!1),S(!1),a(M=>[...M,{id:Date.now().toString(),role:"model",text:"**[Generation Stopped by User]**"}])},Ce=async M=>{var ge;const j=u;if(!j.trim()&&!I||p||d)return;if(P.current&&P.current.abort(),P.current=new AbortController,D==="init"&&j.toLowerCase().match(/yes|ok|start|scan/)){c(""),a(Z=>[...Z,{id:Date.now().toString(),role:"user",text:j}]),W();return}const oe=qc(j);if(!oe.allowed){a(Z=>[...Z,{id:Date.now().toString(),role:"user",text:j},{id:Date.now().toString()+"-guard",role:"model",text:oe.message||"I am strictly a Fallout 4 modding assistant."}]),c("");return}const te={id:Date.now().toString(),role:"user",text:j,images:I?[URL.createObjectURL(I)]:void 0};a(Z=>[...Z,te]),c(""),f(!0),rt(),await Ht.recordAction("chat_message",{length:j.length,hasImages:!!I,timestamp:new Date().toISOString()}),D==="project_setup"&&(Be({name:j,description:"Auto-created from chat",categories:[]}),B("ready"));try{console.log("[Mossy] Initializing AI Session...");const Z="AIzaSyB0n0hMsy-ilO2znsdTb0exWJt3L-UtAv4",re=new Fn({apiKey:Z}),J=o.filter(Y=>Y.role!=="system"&&!Y.text.includes("Scan Complete")).map(Y=>{const de=[];return Y.text&&Y.text.trim().length>0&&de.push({text:Y.text}),Y.toolCall&&(de.push({functionCall:{name:Y.toolCall.toolName,args:Y.toolCall.args}}),Y.toolResult&&de.push({functionResponse:{name:Y.toolCall.toolName,response:{result:Y.toolResult}}})),de.length===0&&de.push({text:"[Image Uploaded]"}),{role:Y.role,parts:de}}),we=[];if(I){const Y=await new Promise(de=>{const Se=new FileReader;Se.onloadend=()=>de(Se.result),Se.readAsDataURL(I)});we.push({inlineData:{mimeType:I.type,data:Y.split(",")[1]}})}we.push({text:j});const Ie=[...J,{role:"user",parts:we}],Q=[{functionDeclarations:Pi}];S(!0);const ye=Ai(L()),E=re.getGenerativeModel({model:"gemini-1.5-flash",systemInstruction:ye,tools:Q}),$=(Date.now()+1).toString();a(Y=>[...Y,{id:$,role:"model",text:"..Establishing Neural Uplink.."}]);let ee="",ce="";const ue=()=>{const Y=ee+ce;a(de=>de.map(Se=>Se.id===$?{...Se,text:Y||"..Processing.."}:Se))};Ht.generateResponse(j,ye).then(Y=>{ee=`**[Local Inference]**
${Y.content}

---
`,ue()}).catch(Y=>console.warn("Local ML failed",Y)),console.log("[Mossy] Starting Content Stream...");const ze=await E.generateContentStream({contents:Ie});try{for await(const Y of ze.stream){if((ge=P.current)!=null&&ge.signal.aborted)break;try{let de="";try{de=Y.text(),ce+=de,ue()}catch{}const Se=Y.functionCalls();if(Se&&Se.length>0)for(const ve of Se)try{console.log("[Mossy] Executing Tool:",ve.name);const xe=await Te(ve.name,ve.args),We=(xe==null?void 0:xe.result)||xe;ce+=`

[System: Executed ${ve.name}]
`,a(it=>it.map(Ue=>Ue.id===$?{...Ue,toolCall:{toolName:ve.name,args:ve.args},toolResult:We}:Ue)),ue()}catch(xe){console.error("[Mossy] Tool execution error:",xe);const We=xe instanceof Error?xe.message:String(xe);ce+=`

[System: Tool ${ve.name} failed - ${We}]
`,a(it=>it.map(Ue=>Ue.id===$?{...Ue,toolCall:{toolName:ve.name,args:ve.args},toolResult:`Error executing ${ve.name}: ${We}`}:Ue)),ue()}}catch(de){console.error("[Mossy] Chunk processing error (continuing stream):",de)}}}catch(Y){console.error("[Mossy] Stream error:",Y);const de=Y instanceof Error?Y.message:String(Y);ce+=`

[Stream interrupted: ${de}]`,ue()}U&&ce&&x(ce)}catch(Z){console.error(Z);const re=Z instanceof Error?Z.message:"Unknown error";re.includes("not found")||re.includes("404")?a(J=>[...J,{id:Date.now().toString(),role:"model",text:"**Connection Lost:** The Google AI Studio service is currently unreachable."}]):re.includes("implemented")||re.includes("supported")?a(J=>[...J,{id:Date.now().toString(),role:"model",text:"**System Limitation:** Tool execution unavailable in current stream configuration. I'll describe the action instead."}]):a(J=>[...J,{id:Date.now().toString(),role:"model",text:`**System Error:** ${re}`}])}finally{f(!1),S(!1),F(null),P.current=null}};return g.jsxs("div",{className:"flex flex-col h-full bg-forge-dark text-slate-200",children:[g.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center bg-forge-panel",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2 text-white",children:[g.jsx(Ui,{className:"text-emerald-400"}),"Mossy ",g.jsx("span",{className:"text-[10px] bg-slate-800 px-2 py-0.5 rounded text-emerald-400 border border-emerald-900",children:"FO4 EDITION"})]}),b?g.jsxs("div",{className:"hidden md:flex items-center gap-1.5 px-3 py-1 bg-emerald-500/10 rounded-full border border-emerald-500/20 text-xs animate-fade-in",children:[g.jsx($n,{className:"w-3 h-3 text-emerald-400 animate-pulse"}),g.jsx("span",{className:"text-emerald-300",children:"Connected"})]}):g.jsxs("div",{className:"hidden md:flex items-center gap-1.5 px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs opacity-50",children:[g.jsx($n,{className:"w-3 h-3 text-slate-400"}),g.jsx("span",{className:"text-slate-400",children:"Localhost Disconnected"})]}),k&&g.jsxs("div",{className:"hidden md:flex items-center gap-1.5 px-3 py-1 bg-orange-900/20 border border-orange-500/30 rounded-full text-xs text-orange-400 animate-fade-in",children:[g.jsx(nn,{className:"w-3 h-3"})," Blender Active"]}),fe&&g.jsxs("div",{className:"hidden md:flex items-center gap-2 px-3 py-1 bg-slate-800 rounded-full border border-slate-600 text-xs",children:[g.jsx(Fr,{className:"w-3 h-3 text-emerald-400"}),g.jsx("span",{className:"text-emerald-100 max-w-[150px] truncate",children:fe})]})]}),g.jsxs("div",{className:"flex gap-2 items-center",children:[g.jsxs("div",{className:"hidden xl:flex items-center gap-2 mr-2 bg-slate-900 rounded-lg p-1 border border-slate-700 px-3 opacity-80 cursor-not-allowed",title:"Version locked to Fallout 4",children:[g.jsx(Ni,{className:"w-4 h-4 text-emerald-500 ml-2"}),g.jsx("span",{className:"text-xs text-slate-200 font-bold",children:"Fallout 4"}),g.jsx(Li,{className:"w-3 h-3 text-slate-500 ml-2"})]}),k&&g.jsxs("button",{onClick:()=>Te("execute_blender_script",{script:`import bpy

# Force Scene Update
bpy.context.view_layer.update()
print('Mossy: Syncing...')`,description:"Manual Sync (Blender 4.5.5)"}),className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-bold transition-all bg-orange-900/20 border-orange-500/50 text-orange-400 hover:bg-orange-900/40 mr-2",title:"Execute Blender Script",children:[g.jsx(nn,{className:"w-4 h-4"}),g.jsx("span",{children:"Sync"})]}),t?g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-bold transition-all ${n?"bg-slate-800 border-slate-700 text-slate-400":"bg-red-900/20 border-red-500/50 text-red-400"}`,title:"Toggle Global Live Voice",children:[n?g.jsx(Rn,{className:"w-4 h-4"}):g.jsx(Vt,{className:"w-4 h-4"}),n?"Live Muted":"Live Active"]}),g.jsx("button",{onClick:i,className:"p-1.5 rounded-lg border border-red-500/30 hover:bg-red-900/30 text-red-400 transition-colors",title:"Stop Live Session",children:g.jsx(Vn,{className:"w-4 h-4"})})]}):g.jsxs("button",{onClick:Bt,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-medium transition-all ${U?"bg-emerald-500/20 border-emerald-500 text-emerald-300":"bg-slate-800 border-slate-700 text-slate-400 hover:text-white"}`,children:[U?g.jsx(Vt,{className:"w-4 h-4"}):g.jsx(Rn,{className:"w-4 h-4"}),U?"Voice: ON":"Voice: OFF"]}),g.jsx("button",{onClick:zt,className:"p-2 text-slate-400 hover:text-red-400 hover:bg-slate-800 rounded transition-colors",title:"Clear Chat History",children:g.jsx(Mi,{className:"w-4 h-4"})}),g.jsx("button",{onClick:()=>Ae(!Pe),className:`p-2 rounded transition-colors ${Pe?"text-emerald-400 bg-emerald-900/30":"text-slate-400 hover:text-white"}`,children:g.jsx(rn,{className:"w-4 h-4"})})]})]}),g.jsx("div",{className:"flex-1 flex overflow-hidden",children:g.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[g.jsxs(Xc,{messages:o,onboardingState:D,scanProgress:z,detectedApps:h,projectContext:fe,handleIntegrate:le,handleStartProject:Oe,onManualExecute:Qe,children:[O&&g.jsx("div",{className:"flex justify-start animate-slide-up",children:g.jsxs("div",{className:"bg-slate-900 border border-emerald-500/30 rounded-2xl rounded-tl-none p-4 max-w-[85%] shadow-lg",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[g.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg",children:g.jsx(on,{className:"w-4 h-4 text-emerald-400"})}),g.jsxs("div",{children:[g.jsx("div",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:"Bridge Command"}),g.jsx("div",{className:"text-sm font-mono text-white",children:O.toolName})]}),O.status==="running"&&g.jsx(Un,{className:"w-4 h-4 text-emerald-500 animate-spin ml-auto"}),O.status==="success"&&g.jsx($r,{className:"w-4 h-4 text-emerald-500 ml-auto"})]}),g.jsxs("div",{className:"bg-black/50 rounded border border-slate-700/50 p-2 font-mono text-xs text-slate-300 overflow-x-auto mb-2",children:[g.jsx("span",{className:"text-emerald-500",children:"$"})," ",JSON.stringify(O.args)]}),O.result&&g.jsxs("div",{className:"text-xs text-emerald-300/80 border-l-2 border-emerald-500/50 pl-2 mt-2 whitespace-pre-wrap",children:[">"," ",O.result]})]})}),(p||d)&&!O&&g.jsx("div",{className:"flex justify-start",children:g.jsxs("div",{className:"bg-forge-panel border border-slate-700 rounded-2xl rounded-tl-none p-4 flex items-center gap-3 shadow-sm",children:[d?g.jsx(Fi,{className:"w-4 h-4 text-emerald-400 animate-pulse"}):g.jsx(Un,{className:"animate-spin text-emerald-400 w-4 h-4"}),g.jsx("span",{className:"text-slate-400 text-sm font-medium",children:d?"Mossy is typing...":"Mossy is thinking..."}),g.jsx("button",{onClick:Ze,className:"ml-4 p-1 hover:bg-slate-700 rounded-full text-slate-500 hover:text-white",title:"Stop Generation",children:g.jsx(Qi,{className:"w-3 h-3 fill-current"})})]})}),g.jsx("div",{ref:Ct})]}),g.jsx("div",{className:"p-4 bg-forge-panel border-t border-slate-700 z-10",children:D==="project_setup"?g.jsx(Gc,{onCancel:()=>{B("ready"),a(M=>[...M,{id:Date.now().toString(),role:"model",text:"Project setup cancelled."}])},onSubmit:M=>{Be(M),B("ready"),a(j=>[...j,{id:Date.now().toString(),role:"model",text:`**Project Initialized:** ${M.name}

Categories: ${M.categories.join(", ")}

I've set up your workspace. Ready to begin?`}])}}):g.jsxs(g.Fragment,{children:[I&&g.jsxs("div",{className:"flex items-center gap-2 mb-2 bg-slate-800 p-2 rounded-lg w-fit text-sm border border-slate-600",children:[g.jsx("div",{className:"bg-slate-700 p-1 rounded",children:g.jsx(rn,{className:"w-4 h-4 text-slate-300"})}),g.jsx("span",{className:"truncate max-w-[200px] text-slate-200",children:I.name}),g.jsx("button",{onClick:()=>F(null),className:"hover:text-red-400 p-1 rounded-full hover:bg-slate-700",children:g.jsx(Rr,{className:"w-3 h-3"})})]}),(ne||N)&&g.jsxs("div",{className:"flex items-center gap-3 mb-2 px-3 py-1.5 bg-slate-800/50 rounded-lg border border-slate-700/50 w-fit",children:[ne&&g.jsxs("span",{className:"flex items-center gap-2 text-xs text-red-400 animate-pulse font-medium",children:[g.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})," Listening..."]}),N&&g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("span",{className:"flex items-center gap-2 text-xs text-emerald-400 font-medium",children:[g.jsx(Vt,{className:"w-3 h-3"})," Speaking..."]}),g.jsx("button",{onClick:rt,className:"p-1 rounded-full hover:bg-red-500/20 text-slate-400 hover:text-red-400",children:g.jsx(Vn,{className:"w-3 h-3"})})]})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs("label",{className:"p-3 hover:bg-slate-700 rounded-xl cursor-pointer text-slate-400 transition-colors border border-transparent hover:border-slate-600",children:[g.jsx("input",{type:"file",className:"hidden",onChange:M=>M.target.files&&F(M.target.files[0]),accept:".psc,.nif,.dds,image/*,text/*"}),g.jsx(Hi,{className:"w-5 h-5"})]}),g.jsx("button",{onClick:Ut,disabled:ne||t,className:`p-3 rounded-xl transition-all border ${ne?"bg-red-500/20 text-red-400 border-red-500/50 animate-pulse":t?"bg-slate-900 text-slate-600 cursor-not-allowed border-transparent":"bg-slate-800 text-slate-400 hover:text-white border-transparent hover:border-slate-600 hover:bg-slate-700"}`,title:t?"Microphone in use by Live Interface":"Voice Input",children:g.jsx(Oi,{className:"w-5 h-5"})}),g.jsx("input",{type:"text",className:"flex-1 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2 focus:outline-none focus:border-emerald-500 transition-colors text-slate-100 placeholder-slate-500",placeholder:"Message Mossy...",value:u,onChange:M=>c(M.target.value),onKeyDown:M=>M.key==="Enter"&&Ce()}),g.jsx("button",{onClick:()=>Ce(),disabled:p||d||!u&&!I,className:"p-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors shadow-lg shadow-emerald-900/20",children:g.jsx(Ji,{className:"w-5 h-5"})})]})]})})]})})]})};export{pu as ChatInterface,pu as default};
